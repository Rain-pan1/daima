main_node:
import time
import yaml
import copy
import math
import random
import argparse
import numpy as np
import torch
import torch.nn as nn
import torch.nn.functional as F
import torchmetrics
from sklearn.metrics import roc_auc_score, mean_absolute_error, accuracy_score, r2_score
from model_node import Specformer
from utils import count_parameters, init_params, seed_everything, get_split


def main_worker(args, config):
    print("Args:", args)
    print("Config:", config)
    seed_everything(args.seed)

    # GPU运行设置
    if torch.cuda.is_available() and args.cuda >= 0:
        device = torch.device(f'cuda:{args.cuda}')
        torch.cuda.set_device(args.cuda)
        torch.cuda.empty_cache()
        print(f"Using GPU: {torch.cuda.get_device_name(args.cuda)}")
    else:
        device = torch.device('cpu')
        print("Using CPU")

    # === 移除所有硬编码的数据集特定配置覆盖 ===
    # 直接使用传入的config参数，让超参数搜索完全控制

    epoch = config['epoch']
    lr = config['lr']
    weight_decay = config['weight_decay']
    nclass = config['nclass']
    nlayer = config['nlayer']
    hidden_dim = config['hidden_dim']
    num_heads = config['num_heads']
    tran_dropout = config['tran_dropout']
    feat_dropout = config['feat_dropout']
    prop_dropout = config['prop_dropout']
    norm = config['norm']

    glct_a = config.get('glct_a', 0)
    glct_b = config.get('glct_b', 1)
    glct_d = config.get('glct_d', 0)
    glct_lr_multiplier = config.get('glct_lr_multiplier', 50.0)

    # === 移除固定的GLCT参数初始化 ===
    # 直接使用config中的GLCT参数设置

    # 加载数据并移动到设备
    if 'signal' in args.dataset:
        e, u, x, y, m = torch.load('data/{}.pt'.format(args.dataset))
        e, u, x, y, m = e.to(device), u.to(device), x.to(device), y.to(device), m.to(device)
        mask = torch.where(m == 1)
        x = x[:, args.image].unsqueeze(1)
        y = y[:, args.image]
    else:
        e, u, x, y = torch.load('data/{}.pt'.format(args.dataset))

        # 内存优化：对于大图数据集，分批处理
        if args.dataset == 'photo' and x.shape[0] > 10000:
            print("Using memory optimization for large graph")
            # 只移动必要的张量到GPU
            e, u = e.to(device), u.to(device)
            # 特征和标签保持在CPU，训练时按需移动
            x_cpu, y_cpu = x, y
            x, y = None, None
        else:
            e, u, x, y = e.to(device), u.to(device), x.to(device), y.to(device)
            x_cpu, y_cpu = None, None

        if len(y.size()) > 1:
            if y.size(1) > 1:
                y = torch.argmax(y, dim=1)
            else:
                y = y.view(-1)

        train, valid, test = get_split(args.dataset, y, nclass, args.seed)
        train, valid, test = map(torch.LongTensor, (train, valid, test))
        train, valid, test = train.to(device), valid.to(device), test.to(device)

    nfeat = x.size(1) if x is not None else x_cpu.size(1)

    net = Specformer(nclass, nfeat, nlayer, hidden_dim, num_heads, tran_dropout,
                     feat_dropout, prop_dropout, norm, glct_a, glct_b, glct_d, glct_lr_multiplier).to(device)
    net.apply(init_params)

    # 正确分离GLCT参数和其他参数
    glct_params = []
    other_params = []
    for name, param in net.named_parameters():
        # 只选择真正的GLCT参数（标量参数）
        if 'actual_a' in name or 'actual_b' in name or 'actual_d' in name:
            glct_params.append(param)
        else:
            other_params.append(param)

    if glct_params:
        optimizer = torch.optim.Adam([
            {'params': other_params, 'lr': lr, 'weight_decay': weight_decay},
            {'params': glct_params, 'lr': lr * net.get_glct_lr_multiplier(), 'weight_decay': 0.0}
        ])
    else:
        optimizer = torch.optim.Adam(net.parameters(), lr=lr, weight_decay=weight_decay)

    print("Parameters:", count_parameters(net))
    print(f"GLCT parameters: a={glct_a}, b={glct_b}, d={glct_d}")

    res = []
    min_loss = 100.0
    max_acc = 0
    counter = 0
    best_test_acc = 0.0
    best_val_acc = 0.0
    patience = 200  # 早停耐心值

    # 在GPU上创建评估指标
    evaluation = torchmetrics.Accuracy(task='multiclass', num_classes=nclass).to(device)

    # === 统一训练参数 ===
    loss_threshold = 20.0  # 统一损失阈值
    clip_value = 2.0       # 统一梯度裁剪值

    for idx in range(epoch):
        net.train()
        optimizer.zero_grad()

        # 内存优化：分批处理大图
        if x_cpu is not None:
            # 将当前批次的特征移动到GPU
            x_batch = x_cpu.to(device)
            y_batch = y_cpu.to(device)
            logits = net(e, u, x_batch)
        else:
            logits = net(e, u, x)
            y_batch = y

        if 'signal' in args.dataset:
            logits = logits.view(y.size())
            loss = torch.square((logits[mask] - y[mask])).sum()
        else:
            loss = F.cross_entropy(logits[train], y_batch[train])

        if torch.isnan(loss) or torch.isinf(loss) or loss > loss_threshold:
            print(f"Epoch {idx}: 损失异常 ({loss.item():.4f})，跳过此次运行")
            # 清理内存
            if x_cpu is not None:
                del x_batch, y_batch
            torch.cuda.empty_cache()
            return 0.0

        loss.backward()

        # 梯度裁剪
        torch.nn.utils.clip_grad_norm_(net.parameters(), max_norm=clip_value)

        optimizer.step()

        # 清理临时变量释放内存
        if x_cpu is not None:
            del x_batch, y_batch

        # 验证阶段
        net.eval()
        with torch.no_grad():
            if x_cpu is not None:
                x_batch = x_cpu.to(device)
                logits = net(e, u, x_batch)
                y_batch = y_cpu.to(device)
            else:
                logits = net(e, u, x)
                y_batch = y

            if 'signal' in args.dataset:
                logits = logits.view(y.size())
                r2 = r2_score(y[mask].data.cpu().numpy(), logits[mask].data.cpu().numpy())
                sse = torch.square(logits[mask] - y[mask]).sum().item()
                if idx % 100 == 0:
                    a, b, d = net.get_glct_params()
                    print(
                        f"Epoch {idx}: R2={r2:.4f}, SSE={sse:.4f}, GLCT_params: a={a.item():.4f}, b={b.item():.4f}, d={d.item():.4f}")
            else:
                val_loss = F.cross_entropy(logits[valid], y_batch[valid]).item()

                if val_loss > loss_threshold:
                    print(f"Epoch {idx}: 验证损失异常 ({val_loss:.4f})，跳过此次运行")
                    if x_cpu is not None:
                        del x_batch, y_batch
                    torch.cuda.empty_cache()
                    return 0.0

                # 直接在GPU上计算准确率
                val_acc = evaluation(logits[valid], y_batch[valid]).item()
                test_acc = evaluation(logits[test], y_batch[test]).item()
                res.append([val_loss, val_acc, test_acc])

                # 每100轮打印关键信息
                if idx % 100 == 0:
                    a, b, d = net.get_glct_params()
                    print(
                        f"Epoch {idx}: Val Loss={val_loss:.4f}, Val Acc={val_acc:.4f}, Test Acc={test_acc:.4f}, GLCT_params: a={a.item():.4f}, b={b.item():.4f}, d={d.item():.4f}")

                # 更新最佳测试准确率
                if test_acc > best_test_acc:
                    best_test_acc = test_acc

                # 早停逻辑 - 基于验证损失
                if val_loss < min_loss:
                    min_loss = val_loss
                    counter = 0
                else:
                    counter += 1

                # 早停逻辑 - 基于验证准确率
                if val_acc > best_val_acc:
                    best_val_acc = val_acc

        # 清理验证阶段的临时变量
        if x_cpu is not None:
            del x_batch, y_batch

        # 定期清理GPU内存
        if idx % 50 == 0:
            torch.cuda.empty_cache()

        # 早停检查
        if counter >= patience:
            # 找到最佳结果
            best_by_loss = sorted(res, key=lambda x: x[0], reverse=False)[0]  # 按验证损失排序
            best_by_acc = sorted(res, key=lambda x: x[1], reverse=True)[0]  # 按验证准确率排序

            best_test_by_loss = best_by_loss[2]
            best_test_by_acc = best_by_acc[2]

            a, b, d = net.get_glct_params()
            print(f"Early stopping at epoch {idx}")
            print(f"Best test acc (by val loss): {best_test_by_loss:.4f}")
            print(f"Best test acc (by val acc): {best_test_by_acc:.4f}")
            print(f"Final GLCT parameters: a={a.item():.4f}, b={b.item():.4f}, d={d.item():.4f}")
            return max(best_test_by_loss, best_test_by_acc, best_test_acc)

    # 如果达到最大epoch
    if res:
        best_by_acc = sorted(res, key=lambda x: x[1], reverse=True)[0]
        best_test_acc_final = best_by_acc[2]
        a, b, d = net.get_glct_params()
        print(f"Reached max epochs. Best test accuracy: {best_test_acc_final:.4f}")
        print(f"Final GLCT parameters: a={a.item():.4f}, b={b.item():.4f}, d={d.item():.4f}")
        return best_test_acc_final

    # 最终清理
    torch.cuda.empty_cache()
    return 0.0


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--seed', type=int, default=1)
    parser.add_argument('--cuda', type=int, default=0, help='GPU device ID (default: 0)')
    parser.add_argument('--dataset', default='cora')
    parser.add_argument('--image', type=int, default=0)
    parser.add_argument('--runs', type=int, default=10, help='Number of runs for statistics')
    parser.add_argument('--seed_start', type=int, default=0, help='Start seed for multiple runs')

    args = parser.parse_args()

    try:
        with open('config.yaml', 'r', encoding='utf-8') as f:
            config_data = yaml.load(f, Loader=yaml.SafeLoader)
    except UnicodeDecodeError:
        try:
            with open('config.yaml', 'r', encoding='gbk') as f:
                config_data = yaml.load(f, Loader=yaml.SafeLoader)
        except:
            with open('config.yaml', 'r', encoding='latin-1') as f:
                config_data = yaml.load(f, Loader=yaml.SafeLoader)

    if 'signal' in args.dataset:
        config = config_data['signal']
    else:
        config = config_data[args.dataset]

    results = []
    valid_runs = 0

    # === 统一有效运行阈值 ===
    threshold = 0.3  # 对所有数据集使用相同的阈值

    for run in range(args.runs):
        print(f"\n=== Run {run + 1}/{args.runs} ===")
        args.seed = args.seed_start + run
        test_acc = main_worker(args, config)

        if test_acc > threshold:
            results.append(test_acc)
            valid_runs += 1
            print(f"Run {run + 1} test accuracy: {test_acc:.4f} (VALID)")
        else:
            print(f"Run {run + 1} test accuracy: {test_acc:.4f} (INVALID - skipped)")

    if results:
        results_array = np.array(results)
        mean_acc = np.mean(results_array)
        std_acc = np.std(results_array)
        confidence_interval = 1.96 * std_acc / np.sqrt(len(results))

        print(f"\n=== Final Results ({valid_runs}/{args.runs} valid runs) ===")
        print(f"Mean test accuracy: {mean_acc:.4f}")
        print(f"Standard deviation: {std_acc:.4f}")
        print(f"95% Confidence interval: [{mean_acc - confidence_interval:.4f}, {mean_acc + confidence_interval:.4f}]")
    else:
        print("No valid results collected")






model_node:
import time
import math
import random
import torch
import torch.nn as nn
import torch.nn.functional as F
import numpy as np
from torch.nn.init import xavier_uniform_, xavier_normal_, constant_


class SineEncoding(nn.Module):
    def __init__(self, hidden_dim=128):
        super(SineEncoding, self).__init__()
        self.constant = 100
        self.hidden_dim = hidden_dim
        self.eig_w = nn.Linear(hidden_dim + 1, hidden_dim)

    def forward(self, e):
        device = e.device
        ee = e * self.constant
        div = torch.exp(torch.arange(0, self.hidden_dim, 2, device=device) * (-math.log(10000) / self.hidden_dim))
        pe = ee.unsqueeze(1) * div
        eeig = torch.cat((e.unsqueeze(1), torch.sin(pe), torch.cos(pe)), dim=1)
        return self.eig_w(eeig)


class GLCTTransform(nn.Module):
    """
    稳定的GLCT简化版本
    只对特征值进行核心的GLCT数学变换，保持特征向量基不变
    """

    def __init__(self):
        super(GLCTTransform, self).__init__()

    def forward(self, eigenvalues, a, b, d):
        """
        稳定的GLCT特征值变换
        只进行核心的GLCT数学变换，避免复杂的非线性组合
        """
        device = eigenvalues.device

        # 确保特征值为正且范围合理
        e_positive = torch.clamp(eigenvalues, min=1e-6, max=2.0)

        # 退化情况：当参数接近默认值时，返回原始特征值
        if (torch.abs(a) < 1e-4 and torch.abs(b - 1.0) < 1e-4 and torch.abs(d) < 1e-4):
            return e_positive

        try:
            # === 核心GLCT数学变换 ===
            # 计算c参数
            c = (a * d - 1.0) / b if torch.abs(b) > 1e-8 else torch.tensor(0.0, device=device)

            denominator = a ** 2 + b ** 2 + 1e-8  # 避免除零

            # xi参数
            xi = (a * c + b * d) / denominator

            # sigma参数
            sigma = torch.sqrt(denominator)

            # alpha参数
            alpha_val = a / sigma
            alpha_val = torch.clamp(alpha_val, 0.1, 0.99)  # 限制在合理范围
            alpha = (2.0 * torch.acos(alpha_val)) / math.pi

            # === 逐步应用GLCT变换 ===
            transformed = e_positive.clone()

            # 第一步：CM变换 (J^xi)
            if torch.abs(xi) > 1e-6:
                transformed = torch.pow(transformed, xi)

            # 第二步：Scaling变换 (/sigma)
            if torch.abs(sigma) > 1e-6:
                transformed = transformed / sigma

            # 第三步：GFRFT变换 (J^alpha)
            if torch.abs(alpha) > 1e-6:
                transformed = torch.pow(transformed, alpha)

            # 数值稳定性约束
            transformed = torch.clamp(transformed, min=1e-6, max=5.0)

            return transformed

        except Exception as e:
            print(f"GLCT transform error: {e}, using original eigenvalues")
            return e_positive


class FeedForwardNetwork(nn.Module):
    def __init__(self, input_dim, hidden_dim, output_dim):
        super(FeedForwardNetwork, self).__init__()
        self.layer1 = nn.Linear(input_dim, hidden_dim)
        self.gelu = nn.GELU()
        self.layer2 = nn.Linear(hidden_dim, output_dim)

    def forward(self, x):
        x = self.layer1(x)
        x = self.gelu(x)
        x = self.layer2(x)
        return x


class SpecLayer(nn.Module):
    def __init__(self, nbases, ncombines, prop_dropout=0.0, norm='none'):
        super(SpecLayer, self).__init__()
        self.prop_dropout = nn.Dropout(prop_dropout)

        if norm == 'none':
            self.weight = nn.Parameter(torch.ones((1, nbases, ncombines)))
        else:
            self.weight = nn.Parameter(torch.empty((1, nbases, ncombines)))
            nn.init.normal_(self.weight, mean=0.0, std=0.01)

        if norm == 'layer':
            self.norm = nn.LayerNorm(ncombines)
        elif norm == 'batch':
            self.norm = nn.BatchNorm1d(ncombines)
        else:
            self.norm = None

    def forward(self, x):
        x = self.prop_dropout(x) * self.weight
        x = torch.sum(x, dim=1)

        if self.norm is not None:
            x = self.norm(x)
            x = F.relu(x)

        return x


class Specformer(nn.Module):
    def __init__(self, nclass, nfeat, nlayer=1, hidden_dim=128, nheads=1,
                 tran_dropout=0.0, feat_dropout=0.0, prop_dropout=0.0, norm='none',
                 glct_a=0, glct_b=1, glct_d=0, glct_lr_multiplier=20.0):  # 降低学习率倍率
        super(Specformer, self).__init__()

        self.norm = norm
        self.nfeat = nfeat
        self.nlayer = nlayer
        self.nheads = nheads
        self.hidden_dim = hidden_dim
        self.glct_lr_multiplier = glct_lr_multiplier

        self.feat_encoder = nn.Sequential(
            nn.Linear(nfeat, hidden_dim),
            nn.ReLU(),
            nn.Linear(hidden_dim, nclass),
        )

        self.linear_encoder = nn.Linear(nfeat, hidden_dim)
        self.classify = nn.Linear(hidden_dim, nclass)

        self.eig_encoder = SineEncoding(hidden_dim)
        self.decoder = nn.Linear(hidden_dim, nheads)

        self.mha_norm = nn.LayerNorm(hidden_dim)
        self.ffn_norm = nn.LayerNorm(hidden_dim)
        self.mha_dropout = nn.Dropout(tran_dropout)
        self.ffn_dropout = nn.Dropout(tran_dropout)
        self.mha = nn.MultiheadAttention(hidden_dim, nheads, tran_dropout)
        self.ffn = FeedForwardNetwork(hidden_dim, hidden_dim, hidden_dim)

        self.feat_dp1 = nn.Dropout(feat_dropout)
        self.feat_dp2 = nn.Dropout(feat_dropout)

        # GLCT变换 - 使用简化稳定版本
        self.glct_transform = GLCTTransform()

        # GLCT参数 - 使用更温和的初始化
        init_perturb = 0.005  # 进一步减小初始化扰动
        glct_a = glct_a + random.uniform(-init_perturb, init_perturb)
        glct_b = glct_b + random.uniform(-init_perturb, init_perturb)
        glct_d = glct_d + random.uniform(-init_perturb, init_perturb)

        self.actual_a = nn.Parameter(torch.tensor(glct_a * 1.0))
        self.actual_b = nn.Parameter(torch.tensor(glct_b * 1.0))
        self.actual_d = nn.Parameter(torch.tensor(glct_d * 1.0))

        if norm == 'none':
            self.layers = nn.ModuleList([SpecLayer(nheads + 1, nclass, prop_dropout, norm=norm) for i in range(nlayer)])
        else:
            self.layers = nn.ModuleList(
                [SpecLayer(nheads + 1, hidden_dim, prop_dropout, norm=norm) for i in range(nlayer)])

    def get_glct_params(self):
        """获取GLCT参数 - 使用合理的约束范围"""
        a = torch.clamp(self.actual_a, -2.0, 2.0)  # 放宽约束范围
        b = torch.clamp(self.actual_b, 0.01, 3.0)  # 合理的范围
        d = torch.clamp(self.actual_d, -2.0, 2.0)  # 放宽约束范围
        return a, b, d

    def get_glct_lr_multiplier(self):
        """获取GLCT参数的学习率倍率"""
        return self.glct_lr_multiplier

    def apply_glct_transform(self, eigenvalues, u):
        """应用GLCT变换到特征值上，保持特征向量基不变"""
        a, b, d = self.get_glct_params()
        transformed_eigenvalues = self.glct_transform(eigenvalues, a, b, d)
        # 特征向量基保持不变
        return transformed_eigenvalues, u, u.permute(1, 0)

    def forward(self, e, u, x):
        # 应用GLCT变换
        e_transformed, u_glct, ut_glct = self.apply_glct_transform(e, u)

        N = e.size(0)

        if self.norm == 'none':
            h = self.feat_dp1(x)
            h = self.feat_encoder(h)
            h = self.feat_dp2(h)
        else:
            h = self.feat_dp1(x)
            h = self.linear_encoder(h)

        # 使用变换后的特征值进行编码
        eig = self.eig_encoder(e_transformed)

        mha_eig = self.mha_norm(eig)
        mha_eig, attn = self.mha(mha_eig, mha_eig, mha_eig)
        eig = eig + self.mha_dropout(mha_eig)

        ffn_eig = self.ffn_norm(eig)
        ffn_eig = self.ffn(ffn_eig)
        eig = eig + self.ffn_dropout(ffn_eig)

        new_e = self.decoder(eig)

        for conv in self.layers:
            basic_feats = [h]
            utx = ut_glct @ h
            for i in range(self.nheads):
                basic_feats.append(u_glct @ (new_e[:, i].unsqueeze(1) * utx))
            basic_feats = torch.stack(basic_feats, axis=1)
            h = conv(basic_feats)

        if self.norm == 'none':
            return h
        else:
            h = self.feat_dp2(h)
            h = self.classify(h)
            return h







config.yaml:
signal:
    nclass: 1
    nlayer: 1
    num_heads: 1
    hidden_dim: 16
    epoch: 2000
    lr: 0.01
    weight_decay: 0.0
    tran_dropout: 0.0
    feat_dropout: 0.0
    prop_dropout: 0.0
    norm: 'none'
    glct_a: 0
    glct_b: 1
    glct_d: 0
    glct_lr_multiplier: 20.0
cora:
    nclass: 7
    nlayer: 2
    num_heads: 4
    hidden_dim: 64
    epoch: 2000
    lr: 0.0002
    weight_decay: 0.0001
    tran_dropout: 0.3
    feat_dropout: 0.6
    prop_dropout: 0.3
    norm: 'none'
    glct_a: 0.5
    glct_b: 1.0
    glct_d: 0.5
    glct_lr_multiplier: 50.0
citeseer:
    nclass: 6
    nlayer: 2
    num_heads: 2
    hidden_dim: 32
    epoch: 2000
    lr: 0.0002
    weight_decay: 0.001
    tran_dropout: 0.0
    feat_dropout: 0.7
    prop_dropout: 0.5
    norm: 'none'
    glct_a: 0.5
    glct_b: 1.0
    glct_d: 0.5
    glct_lr_multiplier: 50.0
photo:
    nclass: 8
    nlayer: 2
    num_heads: 4
    hidden_dim: 32
    epoch: 2000
    lr: 0.0008
    weight_decay: 0.0003
    tran_dropout: 0.2
    feat_dropout: 0.3
    prop_dropout: 0.2
    norm: 'none'
    glct_a: 1.5
    glct_b: 1.0
    glct_d: 0.3
    glct_lr_multiplier: 50.0
arxiv:
    nclass: 40
    nlayer: 1
    num_heads: 1
    hidden_dim: 512
    epoch: 2000
    lr: 0.001
    weight_decay: 0.0
    tran_dropout: 0.1
    feat_dropout: 0.1
    prop_dropout: 0.1
    norm: 'layer'
    glct_a: 0
    glct_b: 1
    glct_d: 0
    glct_lr_multiplier: 20.0
chameleon:
    nclass: 5
    nlayer: 2
    num_heads: 4
    hidden_dim: 32
    epoch: 2000
    lr: 0.001
    weight_decay: 0.0005
    tran_dropout: 0.2
    feat_dropout: 0.4
    prop_dropout: 0.5
    norm: 'none'
    glct_a: 0.5
    glct_b: 1.0
    glct_d: 0.5
    glct_lr_multiplier: 20.0
squirrel:
    nclass: 5
    nlayer: 2
    num_heads: 4
    hidden_dim: 32
    epoch: 2000
    lr: 0.002
    weight_decay: 0.001
    tran_dropout: 0.1
    feat_dropout: 0.4
    prop_dropout: 0.4
    norm: 'none'
    glct_a: 0.4
    glct_b: 1.0
    glct_d: 0.2
    glct_lr_multiplier: 20.0
actor:
    nclass: 5
    nlayer: 2
    num_heads: 2
    hidden_dim: 32
    epoch: 2000
    lr: 0.0003
    weight_decay: 0.0004
    tran_dropout: 0.5
    feat_dropout: 0.8
    prop_dropout: 0.5
    norm: 'none'
    glct_a: 1.5
    glct_b: 1.0
    glct_d: 0.5
    glct_lr_multiplier: 50.0
penn:
    nclass: 2
    nlayer: 1
    num_heads: 1
    hidden_dim: 64
    epoch: 2000
    lr: 0.001
    weight_decay: 0.001
    tran_dropout: 0.0
    feat_dropout: 0.4
    prop_dropout: 0.4
    norm: 'batch'
    glct_a: 0
    glct_b: 1
    glct_d: 0
    glct_lr_multiplier: 20.0






preprocess_node_data:
import sys
import os
import math
import time
import pickle as pkl
import scipy as sp
from scipy import io
import numpy as np
import pandas as pd
import networkx as nx
import dgl
import torch
from sklearn.preprocessing import label_binarize
from ogb.nodeproppred.dataset_dgl import DglNodePropPredDataset
from numpy.linalg import eig, eigh


def generate_signal_data():
    data = io.loadmat('node_raw_data/2Dgrid.mat')
    A = data['A']
    x = data['F'].astype(np.float32)
    m = data['mask']

    A = sp.sparse.coo_matrix(A).todense()

    D_vec = np.sum(A, axis=1).A1
    D_vec_invsqrt_corr = 1 / np.sqrt(D_vec)
    D_invsqrt_corr = np.diag(D_vec_invsqrt_corr)
    # 恢复标准化拉普拉斯矩阵
    L = np.eye(10000) - D_invsqrt_corr @ A @ D_invsqrt_corr

    e, u = eigh(L)

    y_low = u @ np.diag(np.array([math.exp(-10 * (ee - 0) ** 2) for ee in e])) @ u.T @ x
    y_high = u @ np.diag(np.array([1 - math.exp(-10 * (ee - 0) ** 2) for ee in e])) @ u.T @ x
    y_band = u @ np.diag(np.array([math.exp(-10 * (ee - 1) ** 2) for ee in e])) @ u.T @ x
    y_rej = u @ np.diag(np.array([1 - math.exp(-10 * (ee - 1) ** 2) for ee in e])) @ u.T @ x
    y_comb = u @ np.diag(np.array([abs(np.sin(ee * math.pi)) for ee in e])) @ u.T @ x

    e = torch.FloatTensor(e)
    u = torch.FloatTensor(u)
    x = torch.FloatTensor(x)
    m = torch.LongTensor(m).squeeze()
    y_low = torch.FloatTensor(y_low)
    y_high = torch.FloatTensor(y_high)
    y_band = torch.FloatTensor(y_band)
    y_rej = torch.FloatTensor(y_rej)
    y_comb = torch.FloatTensor(y_comb)

    torch.save([e, u, x, y_low, m], 'data/signal_low.pt')
    torch.save([e, u, x, y_high, m], 'data/signal_high.pt')
    torch.save([e, u, x, y_band, m], 'data/signal_band.pt')
    torch.save([e, u, x, y_rej, m], 'data/signal_rej.pt')
    torch.save([e, u, x, y_comb, m], 'data/signal_comb.pt')


def normalize_graph(g):
    """
    恢复标准化拉普拉斯矩阵
    L = I - D^(-1/2) A D^(-1/2)
    特征值范围: [0, 2]
    """
    g = np.array(g)
    g = g + g.T
    g[g > 0.] = 1.0
    deg = g.sum(axis=1).reshape(-1)
    deg[deg == 0.] = 1.0
    deg_sqrt = np.diag(deg ** -0.5)
    adj = np.dot(np.dot(deg_sqrt, g), deg_sqrt)
    L = np.eye(g.shape[0]) - adj  # 恢复拉普拉斯矩阵
    return L


def eigen_decompositon(g):
    g = normalize_graph(g)
    e, u = eigh(g)
    return e, u


def parse_index_file(filename):
    index = []
    for line in open(filename):
        index.append(int(line.strip()))
    return index


def feature_normalize(x):
    x = np.array(x)
    rowsum = x.sum(axis=1, keepdims=True)
    rowsum = np.clip(rowsum, 1, 1e10)
    return x / rowsum


def load_data(dataset_str):
    names = ['x', 'y', 'tx', 'ty', 'allx', 'ally', 'graph']
    objects = []
    for i in range(len(names)):
        with open("node_raw_data/{}/ind.{}.{}".format(dataset_str, dataset_str, names[i]), 'rb') as f:
            if sys.version_info > (3, 0):
                objects.append(pkl.load(f, encoding='latin1'))
            else:
                objects.append(pkl.load(f))

    x, y, tx, ty, allx, ally, graph = tuple(objects)
    test_idx_reorder = parse_index_file("node_raw_data/{}/ind.{}.test.index".format(dataset_str, dataset_str))
    test_idx_range = np.sort(test_idx_reorder)

    if dataset_str == 'citeseer':
        test_idx_range_full = range(min(test_idx_reorder), max(test_idx_reorder) + 1)
        tx_extended = sp.sparse.lil_matrix((len(test_idx_range_full), x.shape[1]))
        tx_extended[test_idx_range - min(test_idx_range), :] = tx
        tx = tx_extended
        ty_extended = np.zeros((len(test_idx_range_full), y.shape[1]))
        ty_extended[test_idx_range - min(test_idx_range), :] = ty
        ty = ty_extended

    features = sp.sparse.vstack((allx, tx)).tolil()
    features[test_idx_reorder, :] = features[test_idx_range, :]
    adj = nx.adjacency_matrix(nx.from_dict_of_lists(graph))

    labels = np.vstack((ally, ty))
    labels[test_idx_reorder, :] = labels[test_idx_range, :]

    if labels.shape[1] == 1:
        labels = labels.flatten()
    else:
        labels = np.argmax(labels, axis=1)

    return adj, features, labels


def eig_dgl_adj_sparse(g, sm=0, lm=0):
    A = g.adj(scipy_fmt='csr')
    deg = np.array(A.sum(axis=0)).flatten()
    D_ = sp.sparse.diags(deg ** -0.5)

    # 恢复标准化拉普拉斯矩阵
    A_ = D_.dot(A.dot(D_))
    L_ = sp.sparse.eye(g.num_nodes()) - A_

    if sm > 0:
        e1, u1 = sp.sparse.linalg.eigsh(L_, k=sm, which='SM', tol=1e-5)
        e1, u1 = map(torch.FloatTensor, (e1, u1))

    if lm > 0:
        e2, u2 = sp.sparse.linalg.eigsh(L_, k=lm, which='LM', tol=1e-5)
        e2, u2 = map(torch.FloatTensor, (e2, u2))

    if sm > 0 and lm > 0:
        return torch.cat((e1, e2), dim=0), torch.cat((u1, u2), dim=1)
    elif sm > 0:
        return e1, u1
    elif lm > 0:
        return e2, u2
    else:
        pass


def load_fb100_dataset():
    mat = io.loadmat('node_raw_data/Penn94.mat')
    A = mat['A']
    metadata = mat['local_info']

    edge_index = A.nonzero()
    metadata = metadata.astype(int)
    label = metadata[:, 1] - 1

    feature_vals = np.hstack((np.expand_dims(metadata[:, 0], 1), metadata[:, 2:]))
    features = np.empty((A.shape[0], 0))
    for col in range(feature_vals.shape[1]):
        feat_col = feature_vals[:, col]
        feat_onehot = label_binarize(feat_col, classes=np.unique(feat_col))
        features = np.hstack((features, feat_onehot))

    node_feat = torch.tensor(features, dtype=torch.float)
    num_nodes = metadata.shape[0]
    label = torch.LongTensor(label)

    g = dgl.graph((edge_index[0], edge_index[1]), num_nodes=num_nodes)

    return g, node_feat, label


def generate_node_data(dataset):
    if dataset in ['cora', 'citeseer']:
        adj, x, y = load_data(dataset)
        adj = adj.todense()
        x = x.todense()
        x = feature_normalize(x)
        e, u = eigen_decompositon(adj)

        print(f"Dataset: {dataset}")
        print(f"Features shape: {x.shape}")
        print(f"Labels shape: {y.shape}")
        print(f"Unique labels: {np.unique(y)}, count: {len(np.unique(y))}")
        print(f"Eigenvalue range: [{e.min():.4f}, {e.max():.4f}]")

        e = torch.FloatTensor(e)
        u = torch.FloatTensor(u)
        x = torch.FloatTensor(x)
        y = torch.LongTensor(y)

        torch.save([e, u, x, y], 'data/{}.pt'.format(dataset))
        print(f"Saved {dataset} with shapes: e{e.shape}, u{u.shape}, x{x.shape}, y{y.shape}")

    elif dataset in ['photo']:
        data = np.load('node_raw_data/amazon_electronics_photo.npz', allow_pickle=True)
        adj = sp.sparse.csr_matrix((data['adj_data'], data['adj_indices'], data['adj_indptr']),
                                   shape=data['adj_shape']).toarray()
        feat = sp.sparse.csr_matrix((data['attr_data'], data['attr_indices'], data['attr_indptr']),
                                    shape=data['attr_shape']).toarray()
        x = feature_normalize(feat)
        y = data['labels']
        e, u = eigen_decompositon(adj)

        print(f"Dataset: {dataset}, Eigenvalue range: [{e.min():.4f}, {e.max():.4f}]")

        e = torch.FloatTensor(e)
        u = torch.FloatTensor(u)
        x = torch.FloatTensor(x)
        y = torch.LongTensor(y)

        torch.save([e, u, x, y], 'data/{}.pt'.format(dataset))

    elif dataset in ['arxiv']:
        data = DglNodePropPredDataset('ogbn-arxiv')
        g = data[0][0]
        g = dgl.add_reverse_edges(g)
        g = dgl.to_simple(g)

        e, u = eig_dgl_adj_sparse(g, sm=5000)
        x = g.ndata['feat']
        y = data[0][1].squeeze()

        print(f"Dataset: {dataset}, Eigenvalue range: [{e.min():.4f}, {e.max():.4f}]")

        torch.save([e, u, x, y], 'data/arxiv.pt')

    elif dataset in ['penn']:
        g, x, y = load_fb100_dataset()
        g = dgl.add_reverse_edges(g)
        g = dgl.to_simple(g)

        e, u = eig_dgl_adj_sparse(g, sm=3000, lm=3000)

        print(f"Dataset: {dataset}, Eigenvalue range: [{e.min():.4f}, {e.max():.4f}]")

        torch.save([e, u, x, y], 'data/penn.pt')

    elif dataset in ['chameleon', 'squirrel', 'actor']:
        edge_df = pd.read_csv('node_raw_data/{}/'.format(dataset) + 'out1_graph_edges.txt', sep='\t')
        node_df = pd.read_csv('node_raw_data/{}/'.format(dataset) + 'out1_node_feature_label.txt', sep='\t')
        feature = node_df[node_df.columns[1]]
        y = node_df[node_df.columns[2]]

        num_nodes = len(y)
        adj = np.zeros((num_nodes, num_nodes))

        source = list(edge_df[edge_df.columns[0]])
        target = list(edge_df[edge_df.columns[1]])

        for i in range(len(source)):
            adj[source[i], target[i]] = 1.
            adj[target[i], source[i]] = 1.

        if dataset == 'actor':
            nfeat = 932
            x = np.zeros((len(y), nfeat))

            feature = list(feature)
            feature = [feat.split(',') for feat in feature]
            for ind, feat in enumerate(feature):
                for ff in feat:
                    x[ind, int(ff)] = 1.

            x = feature_normalize(x)
        else:
            feature = list(feature)
            feature = [feat.split(',') for feat in feature]
            new_feat = []

            for feat in feature:
                new_feat.append([int(f) for f in feat])
            x = np.array(new_feat)
            x = feature_normalize(x)

        e, u = eigen_decompositon(adj)

        print(f"Dataset: {dataset}, Eigenvalue range: [{e.min():.4f}, {e.max():.4f}]")

        e = torch.FloatTensor(e)
        u = torch.FloatTensor(u)
        x = torch.FloatTensor(x)
        y = torch.LongTensor(y.values)

        torch.save([e, u, x, y], 'data/{}.pt'.format(dataset))


if __name__ == '__main__':
    #generate_node_data('cora')
    #generate_node_data('citeseer')
    #generate_node_data('photo')
    generate_node_data('chameleon')
    generate_node_data('squirrel')
    #generate_node_data('actor')
    #generate_node_data('penn')
    #generate_node_data('arxiv')






utils:
import time
import math
import random
import numpy as np
import scipy as sp
import os
import torch
import torch.nn as nn
import torch.nn.functional as F
from ogb.nodeproppred.dataset_dgl import DglNodePropPredDataset


def count_parameters(model):
    return sum(p.numel() for p in model.parameters() if p.requires_grad)


def init_params(module):
    if isinstance(module, nn.Linear):
        module.weight.data.normal_(mean=0.0, std=0.01)
        if module.bias is not None:
            module.bias.data.zero_()
    elif isinstance(module, nn.LayerNorm):
        module.bias.data.zero_()
        module.weight.data.fill_(1.0)


def seed_everything(seed):
    random.seed(seed)
    os.environ['PYTHONHASHSEED'] = str(seed)
    np.random.seed(seed)
    torch.manual_seed(seed)
    if torch.cuda.is_available():
        torch.cuda.manual_seed(seed)
        torch.cuda.manual_seed_all(seed)
    torch.backends.cudnn.deterministic = True
    torch.backends.cudnn.benchmark = False


def get_split(dataset, y, nclass, seed=0):
    if dataset == 'arxiv':
        dataset = DglNodePropPredDataset('ogbn-arxiv')
        split = dataset.get_idx_split()
        train, valid, test = split['train'], split['valid'], split['test']
        return train, valid, test

    elif dataset == 'penn':
        split = np.load('node_raw_data/fb100-Penn94-splits.npy', allow_pickle=True)[0]
        train, valid, test = split['train'], split['valid'], split['test']
        return train, valid, test

    else:
        y = y.cpu()

        percls_trn = int(round(0.6 * len(y) / nclass))
        val_lb = int(round(0.2 * len(y)))

        indices = []
        for i in range(nclass):
            index = (y == i).nonzero().view(-1)
            index = index[torch.randperm(index.size(0))]
            indices.append(index)

        train_index = torch.cat([i[:percls_trn] for i in indices], dim=0)
        rest_index = torch.cat([i[percls_trn:] for i in indices], dim=0)
        rest_index = rest_index[torch.randperm(rest_index.size(0))]
        valid_index = rest_index[:val_lb]
        test_index = rest_index[val_lb:]

        return train_index, valid_index, test_index








Cora运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9456, Val Acc=0.2915, Test Acc=0.2759, GLCT_params: a=0.4785, b=1.0275, d=0.5242
Epoch 100: Val Loss=0.4529, Val Acc=0.8672, Test Acc=0.8539, GLCT_params: a=0.4934, b=1.0203, d=0.5568
Epoch 200: Val Loss=0.4474, Val Acc=0.8727, Test Acc=0.8522, GLCT_params: a=0.4980, b=1.0213, d=0.5655
Epoch 300: Val Loss=0.4419, Val Acc=0.8838, Test Acc=0.8670, GLCT_params: a=0.5020, b=1.0269, d=0.5880
Epoch 400: Val Loss=0.4773, Val Acc=0.8782, Test Acc=0.8588, GLCT_params: a=0.5226, b=1.0176, d=0.5848
Early stopping at epoch 405
Best test acc (by val loss): 0.8785
Best test acc (by val acc): 0.8801
Final GLCT parameters: a=0.5148, b=1.0219, d=0.5927
Run 1 test accuracy: 0.8916 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9461, Val Acc=0.1384, Test Acc=0.1199, GLCT_params: a=0.5213, b=0.9785, d=0.4777
Epoch 100: Val Loss=0.6166, Val Acc=0.8137, Test Acc=0.8424, GLCT_params: a=0.5317, b=0.9572, d=0.5322
Epoch 200: Val Loss=0.5186, Val Acc=0.8303, Test Acc=0.8752, GLCT_params: a=0.5746, b=0.9722, d=0.5559
Epoch 300: Val Loss=0.6447, Val Acc=0.8321, Test Acc=0.8539, GLCT_params: a=0.5922, b=0.9688, d=0.5741
Early stopping at epoch 315
Best test acc (by val loss): 0.8818
Best test acc (by val acc): 0.8900
Final GLCT parameters: a=0.5941, b=0.9591, d=0.5697
Run 2 test accuracy: 0.8933 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9456, Val Acc=0.2177, Test Acc=0.2414, GLCT_params: a=0.5278, b=0.9796, d=0.4708
Epoch 100: Val Loss=0.4437, Val Acc=0.8708, Test Acc=0.8588, GLCT_params: a=0.4795, b=1.0291, d=0.5544
Epoch 200: Val Loss=0.5231, Val Acc=0.8432, Test Acc=0.8670, GLCT_params: a=0.5290, b=1.0289, d=0.5395
Early stopping at epoch 280
Best test acc (by val loss): 0.8966
Best test acc (by val acc): 0.8851
Final GLCT parameters: a=0.5405, b=1.0339, d=0.5508
Run 3 test accuracy: 0.8966 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9455, Val Acc=0.4483, Test Acc=0.4171, GLCT_params: a=0.5223, b=0.9756, d=0.4738
Epoch 100: Val Loss=0.3459, Val Acc=0.8819, Test Acc=0.8818, GLCT_params: a=0.4807, b=0.9608, d=0.5447
Epoch 200: Val Loss=0.4965, Val Acc=0.8487, Test Acc=0.8456, GLCT_params: a=0.5317, b=0.9655, d=0.5317
Epoch 300: Val Loss=0.4507, Val Acc=0.8708, Test Acc=0.8571, GLCT_params: a=0.5389, b=0.9675, d=0.5424
Early stopping at epoch 335
Best test acc (by val loss): 0.8801
Best test acc (by val acc): 0.8801
Final GLCT parameters: a=0.5467, b=0.9685, d=0.5411
Run 4 test accuracy: 0.8834 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9457, Val Acc=0.1144, Test Acc=0.1166, GLCT_params: a=0.4730, b=0.9711, d=0.4742
Epoch 100: Val Loss=0.8090, Val Acc=0.7657, Test Acc=0.7849, GLCT_params: a=0.5610, b=0.9822, d=0.5415
Epoch 200: Val Loss=0.5817, Val Acc=0.8284, Test Acc=0.8654, GLCT_params: a=0.6225, b=0.9816, d=0.5710
Epoch 300: Val Loss=0.5928, Val Acc=0.8469, Test Acc=0.8768, GLCT_params: a=0.6181, b=0.9797, d=0.5805
Early stopping at epoch 323
Best test acc (by val loss): 0.8900
Best test acc (by val acc): 0.8900
Final GLCT parameters: a=0.6380, b=0.9825, d=0.5761
Run 5 test accuracy: 0.8916 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9455, Val Acc=0.3155, Test Acc=0.2989, GLCT_params: a=0.4763, b=0.9776, d=0.5278
Epoch 100: Val Loss=0.5025, Val Acc=0.8432, Test Acc=0.8013, GLCT_params: a=0.5014, b=0.9598, d=0.5550
Epoch 200: Val Loss=0.3931, Val Acc=0.8708, Test Acc=0.8243, GLCT_params: a=0.5691, b=0.9427, d=0.5407
Epoch 300: Val Loss=0.3843, Val Acc=0.8838, Test Acc=0.8342, GLCT_params: a=0.5907, b=0.9440, d=0.5398
Epoch 400: Val Loss=0.4189, Val Acc=0.8875, Test Acc=0.8309, GLCT_params: a=0.5980, b=0.9397, d=0.5529
Early stopping at epoch 463
Best test acc (by val loss): 0.8571
Best test acc (by val acc): 0.8522
Final GLCT parameters: a=0.6009, b=0.9420, d=0.5632
Run 6 test accuracy: 0.8752 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9457, Val Acc=0.2878, Test Acc=0.2824, GLCT_params: a=0.4780, b=1.0282, d=0.5248
Epoch 100: Val Loss=0.4252, Val Acc=0.8801, Test Acc=0.8555, GLCT_params: a=0.5426, b=0.9437, d=0.4848
Epoch 200: Val Loss=0.4353, Val Acc=0.8893, Test Acc=0.8506, GLCT_params: a=0.5192, b=0.9451, d=0.5240
Epoch 300: Val Loss=0.4343, Val Acc=0.8893, Test Acc=0.8588, GLCT_params: a=0.5196, b=0.9360, d=0.5291
Early stopping at epoch 385
Best test acc (by val loss): 0.8768
Best test acc (by val acc): 0.8703
Final GLCT parameters: a=0.5239, b=0.9394, d=0.5311
Run 7 test accuracy: 0.8900 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9457, Val Acc=0.2915, Test Acc=0.2939, GLCT_params: a=0.4734, b=1.0213, d=0.5264
Epoch 100: Val Loss=0.4546, Val Acc=0.8764, Test Acc=0.8539, GLCT_params: a=0.4426, b=1.0408, d=0.5731
Epoch 200: Val Loss=0.5647, Val Acc=0.8487, Test Acc=0.8259, GLCT_params: a=0.4700, b=1.0425, d=0.5645
Epoch 300: Val Loss=0.5748, Val Acc=0.8542, Test Acc=0.8243, GLCT_params: a=0.4705, b=1.0264, d=0.5816
Early stopping at epoch 340
Best test acc (by val loss): 0.8736
Best test acc (by val acc): 0.8539
Final GLCT parameters: a=0.4841, b=1.0410, d=0.5791
Run 8 test accuracy: 0.8736 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9456, Val Acc=0.3819, Test Acc=0.3662, GLCT_params: a=0.4723, b=1.0296, d=0.5213
Epoch 100: Val Loss=0.4953, Val Acc=0.8598, Test Acc=0.8637, GLCT_params: a=0.5497, b=1.0423, d=0.5034
Epoch 200: Val Loss=0.5591, Val Acc=0.8542, Test Acc=0.8473, GLCT_params: a=0.5616, b=1.0664, d=0.5125
Epoch 300: Val Loss=0.5195, Val Acc=0.8561, Test Acc=0.8621, GLCT_params: a=0.5689, b=1.0547, d=0.5239
Early stopping at epoch 357
Best test acc (by val loss): 0.8933
Best test acc (by val acc): 0.8883
Final GLCT parameters: a=0.5862, b=1.0450, d=0.5348
Run 9 test accuracy: 0.8933 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='cora', image=0, runs=10, seed_start=0)
Config: {'nclass': 7, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 64, 'epoch': 2000, 'lr': 0.0005, 'weight_decay': 0.0001, 'tran_dropout': 0.3, 'feat_dropout': 0.6, 'prop_dropout': 0.3, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 214235
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.9459, Val Acc=0.1882, Test Acc=0.1741, GLCT_params: a=0.4747, b=1.0237, d=0.5214
Epoch 100: Val Loss=0.6403, Val Acc=0.8266, Test Acc=0.8522, GLCT_params: a=0.4817, b=1.0126, d=0.5612
Epoch 200: Val Loss=0.5273, Val Acc=0.8616, Test Acc=0.8686, GLCT_params: a=0.4906, b=0.9995, d=0.5586
Epoch 300: Val Loss=0.6133, Val Acc=0.8395, Test Acc=0.8637, GLCT_params: a=0.4960, b=1.0230, d=0.5709
Early stopping at epoch 305
Best test acc (by val loss): 0.8834
Best test acc (by val acc): 0.8834
Final GLCT parameters: a=0.4993, b=1.0229, d=0.5684
Run 10 test accuracy: 0.8851 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.8874
Standard deviation: 0.0075
95% Confidence interval: [0.8827, 0.8920]








Citeseer运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7918, Val Acc=0.1940, Test Acc=0.1842, GLCT_params: a=0.5134, b=0.9926, d=0.4892
Epoch 100: Val Loss=1.7783, Val Acc=0.2301, Test Acc=0.2524, GLCT_params: a=0.4680, b=1.0041, d=0.5359
Epoch 200: Val Loss=1.2862, Val Acc=0.8000, Test Acc=0.7967, GLCT_params: a=0.4619, b=0.9789, d=0.5437
Epoch 300: Val Loss=0.7166, Val Acc=0.8135, Test Acc=0.7831, GLCT_params: a=0.4221, b=0.9378, d=0.5656
Epoch 400: Val Loss=0.6967, Val Acc=0.8075, Test Acc=0.7749, GLCT_params: a=0.4215, b=0.9272, d=0.5639
Epoch 500: Val Loss=0.7182, Val Acc=0.7880, Test Acc=0.7599, GLCT_params: a=0.4231, b=0.9276, d=0.5633
Epoch 600: Val Loss=0.6894, Val Acc=0.8030, Test Acc=0.7790, GLCT_params: a=0.4254, b=0.9360, d=0.5652
Epoch 700: Val Loss=0.7002, Val Acc=0.7970, Test Acc=0.7708, GLCT_params: a=0.4284, b=0.9396, d=0.5654
Early stopping at epoch 784
Best test acc (by val loss): 0.7776
Best test acc (by val acc): 0.8063
Final GLCT parameters: a=0.4271, b=0.9328, d=0.5643
Run 1 test accuracy: 0.8145 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.1729, Test Acc=0.1719, GLCT_params: a=0.4865, b=1.0134, d=0.5126
Epoch 100: Val Loss=1.7787, Val Acc=0.1188, Test Acc=0.1310, GLCT_params: a=0.5007, b=1.0184, d=0.5106
Epoch 200: Val Loss=1.2378, Val Acc=0.7729, Test Acc=0.8145, GLCT_params: a=0.4775, b=1.0027, d=0.5326
Epoch 300: Val Loss=0.8507, Val Acc=0.7293, Test Acc=0.7913, GLCT_params: a=0.5074, b=0.9988, d=0.5142
Epoch 400: Val Loss=0.8215, Val Acc=0.7368, Test Acc=0.8076, GLCT_params: a=0.5137, b=1.0032, d=0.5144
Epoch 500: Val Loss=0.8403, Val Acc=0.7368, Test Acc=0.7872, GLCT_params: a=0.5135, b=1.0015, d=0.5147
Epoch 600: Val Loss=0.8545, Val Acc=0.7308, Test Acc=0.7817, GLCT_params: a=0.5161, b=1.0023, d=0.5149
Early stopping at epoch 601
Best test acc (by val loss): 0.8104
Best test acc (by val acc): 0.7981
Final GLCT parameters: a=0.5163, b=1.0024, d=0.5148
Run 2 test accuracy: 0.8404 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7918, Val Acc=0.1444, Test Acc=0.1542, GLCT_params: a=0.4949, b=1.0144, d=0.5055
Epoch 100: Val Loss=1.7764, Val Acc=0.3639, Test Acc=0.3970, GLCT_params: a=0.5091, b=0.9888, d=0.4938
Epoch 200: Val Loss=0.9853, Val Acc=0.8150, Test Acc=0.8172, GLCT_params: a=0.4990, b=0.9657, d=0.5056
Epoch 300: Val Loss=0.7451, Val Acc=0.7774, Test Acc=0.7831, GLCT_params: a=0.4895, b=0.9523, d=0.5106
Epoch 400: Val Loss=0.7511, Val Acc=0.7684, Test Acc=0.7749, GLCT_params: a=0.4879, b=0.9591, d=0.5152
Epoch 500: Val Loss=0.7679, Val Acc=0.7579, Test Acc=0.7749, GLCT_params: a=0.4940, b=0.9624, d=0.5140
Epoch 600: Val Loss=0.7553, Val Acc=0.7594, Test Acc=0.7749, GLCT_params: a=0.4925, b=0.9575, d=0.5146
Epoch 700: Val Loss=0.7528, Val Acc=0.7669, Test Acc=0.7776, GLCT_params: a=0.4950, b=0.9631, d=0.5166
Early stopping at epoch 739
Best test acc (by val loss): 0.7817
Best test acc (by val acc): 0.8145
Final GLCT parameters: a=0.4958, b=0.9612, d=0.5162
Run 3 test accuracy: 0.8172 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7918, Val Acc=0.1624, Test Acc=0.1460, GLCT_params: a=0.4874, b=1.0104, d=0.5087
Epoch 100: Val Loss=1.7803, Val Acc=0.4511, Test Acc=0.4434, GLCT_params: a=0.6189, b=0.8949, d=0.4048
Epoch 200: Val Loss=1.0825, Val Acc=0.7925, Test Acc=0.7954, GLCT_params: a=0.6349, b=0.6765, d=0.1593
Epoch 300: Val Loss=0.7915, Val Acc=0.7699, Test Acc=0.7858, GLCT_params: a=0.7357, b=0.6737, d=0.1035
Epoch 400: Val Loss=0.7765, Val Acc=0.7489, Test Acc=0.7776, GLCT_params: a=0.7564, b=0.6817, d=0.0999
Epoch 500: Val Loss=0.7764, Val Acc=0.7474, Test Acc=0.7640, GLCT_params: a=0.7599, b=0.6873, d=0.1074
Epoch 600: Val Loss=0.7996, Val Acc=0.7429, Test Acc=0.7653, GLCT_params: a=0.7610, b=0.6877, d=0.1053
Early stopping at epoch 618
Best test acc (by val loss): 0.7722
Best test acc (by val acc): 0.8090
Final GLCT parameters: a=0.7638, b=0.6891, d=0.1049
Run 4 test accuracy: 0.8158 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.1925, Test Acc=0.2019, GLCT_params: a=0.4875, b=1.0060, d=0.5089
Epoch 100: Val Loss=1.7773, Val Acc=0.5323, Test Acc=0.4707, GLCT_params: a=0.4622, b=0.9777, d=0.5219
Epoch 200: Val Loss=1.1906, Val Acc=0.8165, Test Acc=0.7749, GLCT_params: a=0.4859, b=0.9660, d=0.5223
Epoch 300: Val Loss=0.7379, Val Acc=0.7759, Test Acc=0.7558, GLCT_params: a=0.5017, b=0.9602, d=0.5201
Epoch 400: Val Loss=0.7609, Val Acc=0.7684, Test Acc=0.7408, GLCT_params: a=0.4995, b=0.9602, d=0.5230
Epoch 500: Val Loss=0.7454, Val Acc=0.7729, Test Acc=0.7422, GLCT_params: a=0.5023, b=0.9594, d=0.5239
Epoch 600: Val Loss=0.7675, Val Acc=0.7684, Test Acc=0.7258, GLCT_params: a=0.5024, b=0.9603, d=0.5262
Early stopping at epoch 638
Best test acc (by val loss): 0.7490
Best test acc (by val acc): 0.7763
Final GLCT parameters: a=0.5051, b=0.9581, d=0.5238
Run 5 test accuracy: 0.7899 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.2481, Test Acc=0.2115, GLCT_params: a=0.4913, b=1.0123, d=0.5129
Epoch 100: Val Loss=1.7756, Val Acc=0.2617, Test Acc=0.2196, GLCT_params: a=0.4876, b=1.1146, d=0.5431
Epoch 200: Val Loss=1.2206, Val Acc=0.7910, Test Acc=0.8199, GLCT_params: a=0.4905, b=1.1051, d=0.5497
Epoch 300: Val Loss=0.7524, Val Acc=0.7774, Test Acc=0.8008, GLCT_params: a=0.4797, b=1.0923, d=0.5587
Epoch 400: Val Loss=0.7270, Val Acc=0.7865, Test Acc=0.7981, GLCT_params: a=0.4696, b=1.0620, d=0.5637
Epoch 500: Val Loss=0.7399, Val Acc=0.7865, Test Acc=0.7913, GLCT_params: a=0.4680, b=1.0681, d=0.5686
Early stopping at epoch 591
Best test acc (by val loss): 0.7954
Best test acc (by val acc): 0.8322
Final GLCT parameters: a=0.4719, b=1.0662, d=0.5701
Run 6 test accuracy: 0.8322 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7918, Val Acc=0.0842, Test Acc=0.0941, GLCT_params: a=0.4930, b=1.0132, d=0.5098
Epoch 100: Val Loss=1.7788, Val Acc=0.2105, Test Acc=0.1978, GLCT_params: a=0.4512, b=1.0324, d=0.5610
Epoch 200: Val Loss=1.2028, Val Acc=0.7955, Test Acc=0.7667, GLCT_params: a=0.4237, b=0.9501, d=0.5756
Epoch 300: Val Loss=0.7970, Val Acc=0.7714, Test Acc=0.7517, GLCT_params: a=0.4246, b=0.9542, d=0.5815
Epoch 400: Val Loss=0.7302, Val Acc=0.7684, Test Acc=0.7708, GLCT_params: a=0.4278, b=0.9587, d=0.5850
Epoch 500: Val Loss=0.7718, Val Acc=0.7609, Test Acc=0.7585, GLCT_params: a=0.4302, b=0.9524, d=0.5838
Early stopping at epoch 566
Best test acc (by val loss): 0.7722
Best test acc (by val acc): 0.7790
Final GLCT parameters: a=0.4227, b=0.9535, d=0.5916
Run 7 test accuracy: 0.8063 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.2211, Test Acc=0.2060, GLCT_params: a=0.5082, b=0.9865, d=0.4915
Epoch 100: Val Loss=1.7813, Val Acc=0.3248, Test Acc=0.3001, GLCT_params: a=0.7002, b=0.8619, d=0.3520
Epoch 200: Val Loss=1.0911, Val Acc=0.7970, Test Acc=0.7967, GLCT_params: a=0.7740, b=0.6230, d=0.0235
Epoch 300: Val Loss=0.7956, Val Acc=0.7774, Test Acc=0.7599, GLCT_params: a=0.8090, b=0.6531, d=0.0493
Epoch 400: Val Loss=0.7712, Val Acc=0.7744, Test Acc=0.7626, GLCT_params: a=0.7927, b=0.6210, d=-0.0130
Epoch 500: Val Loss=0.7416, Val Acc=0.7850, Test Acc=0.7694, GLCT_params: a=0.7284, b=0.5584, d=-0.0787
Epoch 600: Val Loss=0.7685, Val Acc=0.7789, Test Acc=0.7572, GLCT_params: a=0.8721, b=0.6848, d=0.0283
Epoch 700: Val Loss=0.7567, Val Acc=0.7774, Test Acc=0.7640, GLCT_params: a=0.8617, b=0.6726, d=0.0222
Early stopping at epoch 700
Best test acc (by val loss): 0.7694
Best test acc (by val acc): 0.8117
Final GLCT parameters: a=0.8617, b=0.6726, d=0.0222
Run 8 test accuracy: 0.8240 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.2180, Test Acc=0.2251, GLCT_params: a=0.5063, b=0.9947, d=0.4864
Epoch 100: Val Loss=1.7780, Val Acc=0.4331, Test Acc=0.4570, GLCT_params: a=0.5428, b=1.0352, d=0.4871
Epoch 200: Val Loss=1.1639, Val Acc=0.8015, Test Acc=0.8063, GLCT_params: a=0.5393, b=1.0687, d=0.5140
Epoch 300: Val Loss=0.7512, Val Acc=0.7880, Test Acc=0.7844, GLCT_params: a=0.5543, b=1.0352, d=0.5053
Epoch 400: Val Loss=0.7366, Val Acc=0.7865, Test Acc=0.7817, GLCT_params: a=0.5492, b=1.0320, d=0.5091
Epoch 500: Val Loss=0.7193, Val Acc=0.7910, Test Acc=0.7831, GLCT_params: a=0.5514, b=1.0327, d=0.5089
Epoch 600: Val Loss=0.7525, Val Acc=0.7729, Test Acc=0.7776, GLCT_params: a=0.5541, b=1.0396, d=0.5104
Early stopping at epoch 641
Best test acc (by val loss): 0.7885
Best test acc (by val acc): 0.8145
Final GLCT parameters: a=0.5558, b=1.0375, d=0.5090
Run 9 test accuracy: 0.8172 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='citeseer', image=0, runs=10, seed_start=0)
Config: {'nclass': 6, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0002, 'weight_decay': 0.001, 'tran_dropout': 0.0, 'feat_dropout': 0.7, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 245109
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.7917, Val Acc=0.2331, Test Acc=0.2347, GLCT_params: a=0.5096, b=0.9889, d=0.4864
Epoch 100: Val Loss=1.7705, Val Acc=0.3654, Test Acc=0.3520, GLCT_params: a=0.6272, b=0.7321, d=0.2127
Epoch 200: Val Loss=1.3088, Val Acc=0.7203, Test Acc=0.7585, GLCT_params: a=0.9929, b=1.0750, d=0.5456
Epoch 300: Val Loss=0.8219, Val Acc=0.7459, Test Acc=0.7844, GLCT_params: a=0.9675, b=1.0563, d=0.5540
Epoch 400: Val Loss=0.7985, Val Acc=0.7549, Test Acc=0.7694, GLCT_params: a=0.9831, b=1.0503, d=0.5524
Epoch 500: Val Loss=0.8139, Val Acc=0.7414, Test Acc=0.7681, GLCT_params: a=0.9998, b=1.0514, d=0.5508
Early stopping at epoch 540
Best test acc (by val loss): 0.7844
Best test acc (by val acc): 0.8172
Final GLCT parameters: a=0.9983, b=1.0573, d=0.5580
Run 10 test accuracy: 0.8199 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.8177
Standard deviation: 0.0130
95% Confidence interval: [0.8097, 0.8258]





Photo运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.2601, Test Acc=0.2687, GLCT_params: a=1.4650, b=0.9634, d=0.2596
Epoch 100: Val Loss=0.4010, Val Acc=0.8784, Test Acc=0.8735, GLCT_params: a=1.4356, b=0.8660, d=0.1259
Epoch 200: Val Loss=0.2116, Val Acc=0.9379, Test Acc=0.9291, GLCT_params: a=1.4715, b=0.8696, d=0.1145
Epoch 300: Val Loss=0.2069, Val Acc=0.9386, Test Acc=0.9281, GLCT_params: a=1.4829, b=0.8810, d=0.1267
Epoch 400: Val Loss=0.1878, Val Acc=0.9529, Test Acc=0.9388, GLCT_params: a=1.4742, b=0.8759, d=0.1098
Epoch 500: Val Loss=0.2153, Val Acc=0.9353, Test Acc=0.9271, GLCT_params: a=1.4796, b=0.8621, d=0.1221
Epoch 600: Val Loss=0.2217, Val Acc=0.9366, Test Acc=0.9302, GLCT_params: a=1.4816, b=0.8812, d=0.1127
Early stopping at epoch 633
Best test acc (by val loss): 0.9534
Best test acc (by val acc): 0.9514
Final GLCT parameters: a=1.4894, b=0.8755, d=0.1297
Run 1 test accuracy: 0.9550 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.3092, Test Acc=0.2874, GLCT_params: a=1.4579, b=0.9642, d=0.2630
Epoch 100: Val Loss=0.4323, Val Acc=0.8667, Test Acc=0.8740, GLCT_params: a=1.2575, b=0.8093, d=-0.2341
Epoch 200: Val Loss=0.2406, Val Acc=0.9327, Test Acc=0.9362, GLCT_params: a=1.2439, b=0.8286, d=-0.2791
Epoch 300: Val Loss=0.2152, Val Acc=0.9379, Test Acc=0.9408, GLCT_params: a=1.2429, b=0.8342, d=-0.2850
Epoch 400: Val Loss=0.1923, Val Acc=0.9451, Test Acc=0.9484, GLCT_params: a=1.2420, b=0.8354, d=-0.2882
Early stopping at epoch 421
Best test acc (by val loss): 0.9550
Best test acc (by val acc): 0.9484
Final GLCT parameters: a=1.2429, b=0.8360, d=-0.2877
Run 2 test accuracy: 0.9560 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.1176, Test Acc=0.1058, GLCT_params: a=1.5444, b=1.0444, d=0.3355
Epoch 100: Val Loss=0.4902, Val Acc=0.8712, Test Acc=0.8699, GLCT_params: a=1.8115, b=1.1496, d=0.3083
Epoch 200: Val Loss=0.2812, Val Acc=0.9137, Test Acc=0.9185, GLCT_params: a=1.9951, b=1.1988, d=0.2209
Epoch 300: Val Loss=0.1891, Val Acc=0.9562, Test Acc=0.9479, GLCT_params: a=2.0000, b=1.1739, d=0.1776
Early stopping at epoch 396
Best test acc (by val loss): 0.9459
Best test acc (by val acc): 0.9479
Final GLCT parameters: a=2.0000, b=1.2351, d=-0.2749
Run 3 test accuracy: 0.9524 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.1660, Test Acc=0.1918, GLCT_params: a=1.4578, b=0.9607, d=0.2588
Epoch 100: Val Loss=0.7427, Val Acc=0.8144, Test Acc=0.8097, GLCT_params: a=1.8857, b=1.1911, d=0.5318
Epoch 200: Val Loss=0.2600, Val Acc=0.9203, Test Acc=0.9236, GLCT_params: a=1.9004, b=1.2536, d=0.5080
Epoch 300: Val Loss=0.2100, Val Acc=0.9451, Test Acc=0.9423, GLCT_params: a=1.9058, b=1.2423, d=0.5224
Epoch 400: Val Loss=0.2641, Val Acc=0.9294, Test Acc=0.9291, GLCT_params: a=1.9119, b=1.2450, d=0.5150
Epoch 500: Val Loss=0.2369, Val Acc=0.9366, Test Acc=0.9327, GLCT_params: a=1.9157, b=1.2344, d=0.5115
Epoch 600: Val Loss=0.2900, Val Acc=0.9235, Test Acc=0.9236, GLCT_params: a=1.9262, b=1.2242, d=0.5204
Epoch 700: Val Loss=0.2680, Val Acc=0.9320, Test Acc=0.9312, GLCT_params: a=1.9502, b=1.2458, d=0.5098
Early stopping at epoch 767
Best test acc (by val loss): 0.9555
Best test acc (by val acc): 0.9575
Final GLCT parameters: a=1.9589, b=1.2330, d=0.5167
Run 4 test accuracy: 0.9575 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.0392, Test Acc=0.0374, GLCT_params: a=1.4629, b=0.9627, d=0.2600
Epoch 100: Val Loss=0.4091, Val Acc=0.8941, Test Acc=0.9023, GLCT_params: a=2.0000, b=1.1070, d=0.5319
Epoch 200: Val Loss=0.1598, Val Acc=0.9523, Test Acc=0.9398, GLCT_params: a=2.0000, b=1.1231, d=0.6012
Epoch 300: Val Loss=0.2199, Val Acc=0.9327, Test Acc=0.9211, GLCT_params: a=2.0000, b=1.0946, d=0.6034
Epoch 400: Val Loss=0.2119, Val Acc=0.9366, Test Acc=0.9221, GLCT_params: a=2.0000, b=1.0903, d=0.5709
Epoch 500: Val Loss=0.1729, Val Acc=0.9536, Test Acc=0.9428, GLCT_params: a=2.0000, b=1.1059, d=0.5933
Epoch 600: Val Loss=0.2298, Val Acc=0.9379, Test Acc=0.9307, GLCT_params: a=2.0000, b=1.1383, d=0.5295
Early stopping at epoch 603
Best test acc (by val loss): 0.9539
Best test acc (by val acc): 0.9464
Final GLCT parameters: a=2.0000, b=1.1408, d=0.5329
Run 5 test accuracy: 0.9539 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.0706, Test Acc=0.0744, GLCT_params: a=1.4651, b=0.9642, d=0.2640
Epoch 100: Val Loss=0.4997, Val Acc=0.8529, Test Acc=0.8725, GLCT_params: a=1.5634, b=1.0885, d=0.1520
Epoch 200: Val Loss=0.2537, Val Acc=0.9379, Test Acc=0.9246, GLCT_params: a=1.7221, b=1.0490, d=0.2740
Epoch 300: Val Loss=0.2231, Val Acc=0.9464, Test Acc=0.9403, GLCT_params: a=1.7299, b=1.0656, d=0.2757
Epoch 400: Val Loss=0.2412, Val Acc=0.9405, Test Acc=0.9352, GLCT_params: a=1.7291, b=1.0783, d=0.2632
Epoch 500: Val Loss=0.2285, Val Acc=0.9386, Test Acc=0.9388, GLCT_params: a=1.7427, b=1.0787, d=0.2790
Early stopping at epoch 571
Best test acc (by val loss): 0.9590
Best test acc (by val acc): 0.9590
Final GLCT parameters: a=1.7425, b=1.0834, d=0.2756
Run 6 test accuracy: 0.9620 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.1085, Test Acc=0.0997, GLCT_params: a=1.4841, b=0.9844, d=0.2664
Epoch 100: Val Loss=0.5487, Val Acc=0.8477, Test Acc=0.8467, GLCT_params: a=0.9456, b=0.6815, d=-0.6029
Epoch 200: Val Loss=0.2167, Val Acc=0.9405, Test Acc=0.9317, GLCT_params: a=0.6787, b=0.4337, d=-0.7602
Epoch 300: Val Loss=0.2055, Val Acc=0.9464, Test Acc=0.9403, GLCT_params: a=0.7142, b=0.4329, d=-0.7676
Epoch 400: Val Loss=0.3135, Val Acc=0.9170, Test Acc=0.9175, GLCT_params: a=0.7492, b=0.4492, d=-0.7649
Epoch 500: Val Loss=0.3035, Val Acc=0.9222, Test Acc=0.9216, GLCT_params: a=0.7743, b=0.4693, d=-0.7558
Early stopping at epoch 557
Best test acc (by val loss): 0.9600
Best test acc (by val acc): 0.9600
Final GLCT parameters: a=0.7512, b=0.4545, d=-0.7598
Run 7 test accuracy: 0.9605 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.3431, Test Acc=0.3052, GLCT_params: a=1.4797, b=0.9763, d=0.2685
Epoch 100: Val Loss=0.4596, Val Acc=0.8608, Test Acc=0.8785, GLCT_params: a=1.3811, b=0.7105, d=-0.1579
Epoch 200: Val Loss=0.2506, Val Acc=0.9379, Test Acc=0.9378, GLCT_params: a=1.2273, b=0.5375, d=-0.3461
Epoch 300: Val Loss=0.2488, Val Acc=0.9405, Test Acc=0.9403, GLCT_params: a=1.1833, b=0.5150, d=-0.3810
Epoch 400: Val Loss=0.2761, Val Acc=0.9379, Test Acc=0.9423, GLCT_params: a=1.2149, b=0.5452, d=-0.3691
Epoch 500: Val Loss=0.2965, Val Acc=0.9314, Test Acc=0.9367, GLCT_params: a=1.1933, b=0.5376, d=-0.3882
Early stopping at epoch 521
Best test acc (by val loss): 0.9499
Best test acc (by val acc): 0.9600
Final GLCT parameters: a=1.1830, b=0.5316, d=-0.3949
Run 8 test accuracy: 0.9600 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.3556, Test Acc=0.3856, GLCT_params: a=1.5344, b=1.0436, d=0.3353
Epoch 100: Val Loss=0.4221, Val Acc=0.8817, Test Acc=0.8679, GLCT_params: a=1.0785, b=0.5826, d=-0.3314
Epoch 200: Val Loss=0.2054, Val Acc=0.9405, Test Acc=0.9200, GLCT_params: a=1.1175, b=0.6416, d=-0.3667
Epoch 300: Val Loss=0.2427, Val Acc=0.9268, Test Acc=0.9079, GLCT_params: a=1.1257, b=0.6675, d=-0.4041
Epoch 400: Val Loss=0.1709, Val Acc=0.9549, Test Acc=0.9352, GLCT_params: a=1.1515, b=0.6948, d=-0.3807
Epoch 500: Val Loss=0.2225, Val Acc=0.9431, Test Acc=0.9246, GLCT_params: a=1.1515, b=0.6848, d=-0.3739
Early stopping at epoch 572
Best test acc (by val loss): 0.9464
Best test acc (by val acc): 0.9469
Final GLCT parameters: a=1.1570, b=0.6897, d=-0.3677
Run 9 test accuracy: 0.9504 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='photo', image=0, runs=10, seed_start=0)
Config: {'nclass': 8, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0008, 'weight_decay': 0.0003, 'tran_dropout': 0.2, 'feat_dropout': 0.3, 'prop_dropout': 0.2, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.3, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 56039
GLCT parameters: a=1.5, b=1.0, d=0.3
Epoch 0: Val Loss=2.0790, Val Acc=0.1111, Test Acc=0.1139, GLCT_params: a=1.4726, b=0.9631, d=0.2660
Epoch 100: Val Loss=0.4037, Val Acc=0.9092, Test Acc=0.8932, GLCT_params: a=1.2597, b=0.6693, d=-0.1575
Epoch 200: Val Loss=0.2179, Val Acc=0.9418, Test Acc=0.9418, GLCT_params: a=1.2467, b=0.7359, d=-0.2232
Epoch 300: Val Loss=0.2534, Val Acc=0.9366, Test Acc=0.9357, GLCT_params: a=1.2480, b=0.7549, d=-0.2336
Epoch 400: Val Loss=0.2528, Val Acc=0.9340, Test Acc=0.9317, GLCT_params: a=1.2493, b=0.7674, d=-0.2396
Early stopping at epoch 486
Best test acc (by val loss): 0.9580
Best test acc (by val acc): 0.9575
Final GLCT parameters: a=1.2499, b=0.7711, d=-0.2426
Run 10 test accuracy: 0.9605 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.9568
Standard deviation: 0.0037
95% Confidence interval: [0.9545, 0.9591]





Actor运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6095, Val Acc=0.0605, Test Acc=0.0500, GLCT_params: a=1.5149, b=1.0172, d=0.4843
Epoch 100: Val Loss=1.5947, Val Acc=0.3836, Test Acc=0.3800, GLCT_params: a=1.5850, b=0.9658, d=0.5010
Epoch 200: Val Loss=1.5636, Val Acc=0.3579, Test Acc=0.3559, GLCT_params: a=1.7474, b=0.9724, d=0.4145
Epoch 300: Val Loss=1.5612, Val Acc=0.3592, Test Acc=0.3680, GLCT_params: a=1.9111, b=1.0127, d=0.4810
Epoch 400: Val Loss=1.5344, Val Acc=0.3625, Test Acc=0.3559, GLCT_params: a=1.9208, b=0.9020, d=0.4183
Epoch 500: Val Loss=1.5329, Val Acc=0.3586, Test Acc=0.3578, GLCT_params: a=1.9764, b=0.9073, d=0.4309
Epoch 600: Val Loss=1.5267, Val Acc=0.3553, Test Acc=0.3534, GLCT_params: a=2.0000, b=0.8702, d=0.4273
Epoch 700: Val Loss=1.5232, Val Acc=0.3546, Test Acc=0.3559, GLCT_params: a=2.0000, b=0.8980, d=0.4235
Epoch 800: Val Loss=1.5159, Val Acc=0.3520, Test Acc=0.3477, GLCT_params: a=2.0000, b=0.8837, d=0.4146
Epoch 900: Val Loss=1.5093, Val Acc=0.3553, Test Acc=0.3452, GLCT_params: a=2.0000, b=0.8622, d=0.4286
Epoch 1000: Val Loss=1.5057, Val Acc=0.3513, Test Acc=0.3433, GLCT_params: a=2.0000, b=0.8906, d=0.4170
Epoch 1100: Val Loss=1.5040, Val Acc=0.3559, Test Acc=0.3496, GLCT_params: a=2.0000, b=0.8878, d=0.4170
Epoch 1200: Val Loss=1.5029, Val Acc=0.3533, Test Acc=0.3458, GLCT_params: a=2.0000, b=0.8717, d=0.4238
Epoch 1300: Val Loss=1.5007, Val Acc=0.3579, Test Acc=0.3509, GLCT_params: a=2.0000, b=0.9196, d=0.4165
Epoch 1400: Val Loss=1.5082, Val Acc=0.3507, Test Acc=0.3477, GLCT_params: a=2.0000, b=0.8354, d=0.4067
Epoch 1500: Val Loss=1.5090, Val Acc=0.3500, Test Acc=0.3414, GLCT_params: a=2.0000, b=0.8974, d=0.4378
Epoch 1600: Val Loss=1.4960, Val Acc=0.3454, Test Acc=0.3439, GLCT_params: a=2.0000, b=0.8956, d=0.4174
Epoch 1700: Val Loss=1.4997, Val Acc=0.3487, Test Acc=0.3407, GLCT_params: a=2.0000, b=0.8796, d=0.4087
Epoch 1800: Val Loss=1.4909, Val Acc=0.3461, Test Acc=0.3363, GLCT_params: a=2.0000, b=0.8946, d=0.4188
Epoch 1900: Val Loss=1.5008, Val Acc=0.3553, Test Acc=0.3407, GLCT_params: a=2.0000, b=0.9666, d=0.3974
Reached max epochs. Best test accuracy: 0.4186
Final GLCT parameters: a=2.0000, b=0.9222, d=0.4255
Run 1 test accuracy: 0.4186 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.1507, Test Acc=0.1412, GLCT_params: a=1.4878, b=0.9913, d=0.4889
Epoch 100: Val Loss=1.5931, Val Acc=0.4072, Test Acc=0.4167, GLCT_params: a=1.5114, b=0.9788, d=0.4314
Epoch 200: Val Loss=1.5633, Val Acc=0.3763, Test Acc=0.3800, GLCT_params: a=1.6142, b=0.9534, d=0.4527
Epoch 300: Val Loss=1.5575, Val Acc=0.3678, Test Acc=0.3718, GLCT_params: a=1.7681, b=0.9517, d=0.4968
Epoch 400: Val Loss=1.5404, Val Acc=0.3717, Test Acc=0.3648, GLCT_params: a=1.8068, b=0.9388, d=0.4305
Epoch 500: Val Loss=1.5488, Val Acc=0.3599, Test Acc=0.3597, GLCT_params: a=1.8289, b=0.8949, d=0.4118
Epoch 600: Val Loss=1.5216, Val Acc=0.3454, Test Acc=0.3483, GLCT_params: a=1.8955, b=0.9358, d=0.4232
Epoch 700: Val Loss=1.5180, Val Acc=0.3533, Test Acc=0.3528, GLCT_params: a=1.9436, b=0.9954, d=0.4025
Epoch 800: Val Loss=1.5107, Val Acc=0.3487, Test Acc=0.3528, GLCT_params: a=1.9722, b=0.9184, d=0.4198
Epoch 900: Val Loss=1.5173, Val Acc=0.3513, Test Acc=0.3578, GLCT_params: a=2.0000, b=0.9250, d=0.4211
Epoch 1000: Val Loss=1.5183, Val Acc=0.3513, Test Acc=0.3566, GLCT_params: a=2.0000, b=0.9020, d=0.3975
Early stopping at epoch 1037
Best test acc (by val loss): 0.3464
Best test acc (by val acc): 0.4142
Final GLCT parameters: a=2.0000, b=0.9293, d=0.4134
Run 2 test accuracy: 0.4319 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2546, Test Acc=0.2413, GLCT_params: a=1.5191, b=1.0194, d=0.5104
Epoch 100: Val Loss=1.5961, Val Acc=0.3961, Test Acc=0.3933, GLCT_params: a=1.5060, b=0.9126, d=0.4300
Epoch 200: Val Loss=1.5729, Val Acc=0.3480, Test Acc=0.3718, GLCT_params: a=1.5880, b=0.8667, d=0.4954
Epoch 300: Val Loss=1.5583, Val Acc=0.3493, Test Acc=0.3629, GLCT_params: a=1.6689, b=0.9468, d=0.5136
Epoch 400: Val Loss=1.5452, Val Acc=0.3329, Test Acc=0.3572, GLCT_params: a=1.7557, b=0.9741, d=0.5638
Epoch 500: Val Loss=1.5379, Val Acc=0.3428, Test Acc=0.3540, GLCT_params: a=1.7699, b=0.9497, d=0.5925
Epoch 600: Val Loss=1.5316, Val Acc=0.3375, Test Acc=0.3553, GLCT_params: a=1.7625, b=0.9350, d=0.4957
Epoch 700: Val Loss=1.5281, Val Acc=0.3375, Test Acc=0.3578, GLCT_params: a=1.8103, b=0.8796, d=0.6035
Epoch 800: Val Loss=1.5277, Val Acc=0.3316, Test Acc=0.3559, GLCT_params: a=1.8948, b=0.9823, d=0.5901
Epoch 900: Val Loss=1.5214, Val Acc=0.3342, Test Acc=0.3610, GLCT_params: a=1.9157, b=0.9553, d=0.5804
Epoch 1000: Val Loss=1.5227, Val Acc=0.3355, Test Acc=0.3572, GLCT_params: a=1.9207, b=0.9402, d=0.5510
Epoch 1100: Val Loss=1.5157, Val Acc=0.3270, Test Acc=0.3521, GLCT_params: a=1.9869, b=0.9625, d=0.5516
Epoch 1200: Val Loss=1.5117, Val Acc=0.3316, Test Acc=0.3559, GLCT_params: a=2.0000, b=0.9103, d=0.5618
Epoch 1300: Val Loss=1.5139, Val Acc=0.3329, Test Acc=0.3509, GLCT_params: a=2.0000, b=0.8856, d=0.5754
Epoch 1400: Val Loss=1.5104, Val Acc=0.3329, Test Acc=0.3521, GLCT_params: a=2.0000, b=0.9317, d=0.5239
Epoch 1500: Val Loss=1.4999, Val Acc=0.3362, Test Acc=0.3528, GLCT_params: a=2.0000, b=0.9535, d=0.5503
Epoch 1600: Val Loss=1.5022, Val Acc=0.3355, Test Acc=0.3528, GLCT_params: a=2.0000, b=0.9242, d=0.5202
Epoch 1700: Val Loss=1.5039, Val Acc=0.3309, Test Acc=0.3483, GLCT_params: a=2.0000, b=0.9895, d=0.5321
Epoch 1800: Val Loss=1.4950, Val Acc=0.3349, Test Acc=0.3496, GLCT_params: a=2.0000, b=1.0667, d=0.4906
Epoch 1900: Val Loss=1.4927, Val Acc=0.3270, Test Acc=0.3464, GLCT_params: a=2.0000, b=1.1752, d=0.4943
Reached max epochs. Best test accuracy: 0.4129
Final GLCT parameters: a=2.0000, b=1.1486, d=0.4947
Run 3 test accuracy: 0.4129 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2322, Test Acc=0.2128, GLCT_params: a=1.5114, b=1.0152, d=0.5136
Epoch 100: Val Loss=1.6016, Val Acc=0.4013, Test Acc=0.4174, GLCT_params: a=1.4910, b=0.9073, d=0.4788
Epoch 200: Val Loss=1.5636, Val Acc=0.3625, Test Acc=0.3851, GLCT_params: a=1.5547, b=0.8941, d=0.4926
Epoch 300: Val Loss=1.5499, Val Acc=0.3500, Test Acc=0.3813, GLCT_params: a=1.5781, b=0.8740, d=0.4996
Epoch 400: Val Loss=1.5403, Val Acc=0.3592, Test Acc=0.3800, GLCT_params: a=1.6800, b=0.9162, d=0.4774
Epoch 500: Val Loss=1.5273, Val Acc=0.3375, Test Acc=0.3749, GLCT_params: a=1.6828, b=0.8548, d=0.4638
Epoch 600: Val Loss=1.5329, Val Acc=0.3421, Test Acc=0.3724, GLCT_params: a=1.7727, b=0.8906, d=0.4787
Epoch 700: Val Loss=1.5119, Val Acc=0.3408, Test Acc=0.3572, GLCT_params: a=1.8036, b=0.8645, d=0.4519
Epoch 800: Val Loss=1.5163, Val Acc=0.3395, Test Acc=0.3616, GLCT_params: a=1.8350, b=0.8576, d=0.4570
Epoch 900: Val Loss=1.5179, Val Acc=0.3322, Test Acc=0.3673, GLCT_params: a=1.8916, b=0.8632, d=0.4639
Epoch 1000: Val Loss=1.5057, Val Acc=0.3388, Test Acc=0.3648, GLCT_params: a=1.8949, b=0.8378, d=0.4363
Epoch 1100: Val Loss=1.4998, Val Acc=0.3428, Test Acc=0.3591, GLCT_params: a=1.9143, b=0.8326, d=0.4349
Epoch 1200: Val Loss=1.4963, Val Acc=0.3401, Test Acc=0.3534, GLCT_params: a=1.9569, b=0.7819, d=0.4429
Epoch 1300: Val Loss=1.4927, Val Acc=0.3434, Test Acc=0.3591, GLCT_params: a=1.9875, b=0.8737, d=0.4223
Epoch 1400: Val Loss=1.4993, Val Acc=0.3408, Test Acc=0.3648, GLCT_params: a=2.0000, b=0.8468, d=0.4211
Epoch 1500: Val Loss=1.5065, Val Acc=0.3349, Test Acc=0.3629, GLCT_params: a=2.0000, b=0.8633, d=0.4523
Epoch 1600: Val Loss=1.4825, Val Acc=0.3362, Test Acc=0.3559, GLCT_params: a=2.0000, b=0.8387, d=0.4255
Epoch 1700: Val Loss=1.4840, Val Acc=0.3395, Test Acc=0.3553, GLCT_params: a=2.0000, b=0.8884, d=0.4124
Epoch 1800: Val Loss=1.4886, Val Acc=0.3434, Test Acc=0.3623, GLCT_params: a=2.0000, b=0.8280, d=0.4166
Early stopping at epoch 1838
Best test acc (by val loss): 0.3604
Best test acc (by val acc): 0.4167
Final GLCT parameters: a=2.0000, b=0.8446, d=0.4230
Run 4 test accuracy: 0.4345 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.1829, Test Acc=0.1995, GLCT_params: a=1.5079, b=1.0099, d=0.4882
Epoch 100: Val Loss=1.5937, Val Acc=0.3921, Test Acc=0.3882, GLCT_params: a=1.4794, b=0.9152, d=0.4448
Epoch 200: Val Loss=1.5702, Val Acc=0.3586, Test Acc=0.3477, GLCT_params: a=1.5163, b=0.8851, d=0.3732
Epoch 300: Val Loss=1.5517, Val Acc=0.3566, Test Acc=0.3433, GLCT_params: a=1.6906, b=0.8666, d=0.5287
Epoch 400: Val Loss=1.5410, Val Acc=0.3711, Test Acc=0.3502, GLCT_params: a=1.7467, b=0.9085, d=0.4822
Epoch 500: Val Loss=1.5380, Val Acc=0.3559, Test Acc=0.3439, GLCT_params: a=1.8095, b=0.8961, d=0.4537
Epoch 600: Val Loss=1.5296, Val Acc=0.3572, Test Acc=0.3407, GLCT_params: a=1.8303, b=0.8467, d=0.4292
Epoch 700: Val Loss=1.5280, Val Acc=0.3553, Test Acc=0.3350, GLCT_params: a=1.8842, b=0.7838, d=0.4203
Epoch 800: Val Loss=1.5188, Val Acc=0.3539, Test Acc=0.3483, GLCT_params: a=1.9824, b=0.8100, d=0.4472
Epoch 900: Val Loss=1.5131, Val Acc=0.3474, Test Acc=0.3407, GLCT_params: a=2.0000, b=0.8921, d=0.4064
Epoch 1000: Val Loss=1.5051, Val Acc=0.3434, Test Acc=0.3369, GLCT_params: a=2.0000, b=0.8206, d=0.4377
Epoch 1100: Val Loss=1.5125, Val Acc=0.3526, Test Acc=0.3376, GLCT_params: a=2.0000, b=0.8574, d=0.4453
Epoch 1200: Val Loss=1.5082, Val Acc=0.3539, Test Acc=0.3407, GLCT_params: a=2.0000, b=0.8536, d=0.4016
Epoch 1300: Val Loss=1.4898, Val Acc=0.3487, Test Acc=0.3319, GLCT_params: a=2.0000, b=0.9037, d=0.4058
Epoch 1400: Val Loss=1.4880, Val Acc=0.3414, Test Acc=0.3319, GLCT_params: a=2.0000, b=0.8400, d=0.4235
Epoch 1500: Val Loss=1.4854, Val Acc=0.3428, Test Acc=0.3350, GLCT_params: a=2.0000, b=0.8449, d=0.4261
Epoch 1600: Val Loss=1.4959, Val Acc=0.3513, Test Acc=0.3420, GLCT_params: a=2.0000, b=0.8440, d=0.4447
Epoch 1700: Val Loss=1.4856, Val Acc=0.3480, Test Acc=0.3357, GLCT_params: a=2.0000, b=0.8639, d=0.4308
Epoch 1800: Val Loss=1.4855, Val Acc=0.3520, Test Acc=0.3369, GLCT_params: a=2.0000, b=0.8307, d=0.4250
Epoch 1900: Val Loss=1.4765, Val Acc=0.3526, Test Acc=0.3388, GLCT_params: a=2.0000, b=0.8270, d=0.4295
Reached max epochs. Best test accuracy: 0.4161
Final GLCT parameters: a=2.0000, b=0.8587, d=0.4315
Run 5 test accuracy: 0.4161 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2638, Test Acc=0.2609, GLCT_params: a=1.4865, b=0.9875, d=0.4887
Epoch 100: Val Loss=1.5922, Val Acc=0.3401, Test Acc=0.3547, GLCT_params: a=1.2735, b=0.8172, d=0.1622
Epoch 200: Val Loss=1.5595, Val Acc=0.3474, Test Acc=0.3490, GLCT_params: a=1.4946, b=0.9207, d=0.2558
Epoch 300: Val Loss=1.5451, Val Acc=0.3546, Test Acc=0.3585, GLCT_params: a=1.6399, b=0.9709, d=0.4358
Epoch 400: Val Loss=1.5389, Val Acc=0.3401, Test Acc=0.3540, GLCT_params: a=1.6852, b=0.9638, d=0.4881
Epoch 500: Val Loss=1.5349, Val Acc=0.3592, Test Acc=0.3597, GLCT_params: a=1.7450, b=0.9604, d=0.4946
Epoch 600: Val Loss=1.5347, Val Acc=0.3507, Test Acc=0.3578, GLCT_params: a=1.7637, b=0.8671, d=0.4120
Epoch 700: Val Loss=1.5217, Val Acc=0.3513, Test Acc=0.3572, GLCT_params: a=1.8771, b=0.9512, d=0.4154
Epoch 800: Val Loss=1.5106, Val Acc=0.3507, Test Acc=0.3490, GLCT_params: a=1.9139, b=0.9148, d=0.4255
Epoch 900: Val Loss=1.5219, Val Acc=0.3454, Test Acc=0.3502, GLCT_params: a=1.9237, b=0.9346, d=0.4004
Epoch 1000: Val Loss=1.5222, Val Acc=0.3520, Test Acc=0.3483, GLCT_params: a=2.0000, b=0.9968, d=0.4420
Epoch 1100: Val Loss=1.5068, Val Acc=0.3467, Test Acc=0.3496, GLCT_params: a=2.0000, b=1.0254, d=0.3925
Epoch 1200: Val Loss=1.5028, Val Acc=0.3454, Test Acc=0.3496, GLCT_params: a=2.0000, b=0.9411, d=0.4086
Epoch 1300: Val Loss=1.5009, Val Acc=0.3434, Test Acc=0.3490, GLCT_params: a=2.0000, b=0.9574, d=0.4019
Epoch 1400: Val Loss=1.4960, Val Acc=0.3487, Test Acc=0.3483, GLCT_params: a=2.0000, b=0.9423, d=0.4100
Early stopping at epoch 1450
Best test acc (by val loss): 0.3496
Best test acc (by val acc): 0.4186
Final GLCT parameters: a=2.0000, b=0.9317, d=0.3963
Run 6 test accuracy: 0.4231 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6095, Val Acc=0.1447, Test Acc=0.1678, GLCT_params: a=1.4882, b=0.9883, d=0.5148
Epoch 100: Val Loss=1.5975, Val Acc=0.4224, Test Acc=0.4395, GLCT_params: a=1.4317, b=0.8873, d=0.4797
Epoch 200: Val Loss=1.5624, Val Acc=0.3836, Test Acc=0.3806, GLCT_params: a=1.5836, b=0.8964, d=0.4785
Epoch 300: Val Loss=1.5500, Val Acc=0.3566, Test Acc=0.3699, GLCT_params: a=1.5582, b=0.8255, d=0.4163
Epoch 400: Val Loss=1.5326, Val Acc=0.3362, Test Acc=0.3534, GLCT_params: a=1.6802, b=0.8915, d=0.4719
Epoch 500: Val Loss=1.5274, Val Acc=0.3434, Test Acc=0.3572, GLCT_params: a=1.6991, b=0.8575, d=0.4781
Epoch 600: Val Loss=1.5207, Val Acc=0.3401, Test Acc=0.3547, GLCT_params: a=1.7337, b=0.8663, d=0.4817
Epoch 700: Val Loss=1.5192, Val Acc=0.3395, Test Acc=0.3553, GLCT_params: a=1.7289, b=0.8213, d=0.4228
Epoch 800: Val Loss=1.5160, Val Acc=0.3355, Test Acc=0.3502, GLCT_params: a=1.7866, b=0.8421, d=0.4331
Epoch 900: Val Loss=1.5023, Val Acc=0.3349, Test Acc=0.3515, GLCT_params: a=1.8361, b=0.8362, d=0.4423
Epoch 1000: Val Loss=1.4981, Val Acc=0.3368, Test Acc=0.3540, GLCT_params: a=1.8570, b=0.8052, d=0.4558
Epoch 1100: Val Loss=1.4915, Val Acc=0.3322, Test Acc=0.3585, GLCT_params: a=1.8624, b=0.8318, d=0.4449
Epoch 1200: Val Loss=1.4978, Val Acc=0.3382, Test Acc=0.3572, GLCT_params: a=1.8788, b=0.8254, d=0.4388
Epoch 1300: Val Loss=1.4966, Val Acc=0.3408, Test Acc=0.3553, GLCT_params: a=1.9005, b=0.8278, d=0.4235
Epoch 1400: Val Loss=1.4850, Val Acc=0.3355, Test Acc=0.3578, GLCT_params: a=1.9325, b=0.8306, d=0.4376
Epoch 1500: Val Loss=1.4855, Val Acc=0.3342, Test Acc=0.3521, GLCT_params: a=1.9344, b=0.8328, d=0.4377
Epoch 1600: Val Loss=1.4907, Val Acc=0.3461, Test Acc=0.3572, GLCT_params: a=1.9740, b=0.8865, d=0.4344
Epoch 1700: Val Loss=1.4792, Val Acc=0.3375, Test Acc=0.3540, GLCT_params: a=2.0000, b=0.8217, d=0.4351
Epoch 1800: Val Loss=1.4806, Val Acc=0.3329, Test Acc=0.3509, GLCT_params: a=2.0000, b=0.8258, d=0.4291
Epoch 1900: Val Loss=1.4793, Val Acc=0.3329, Test Acc=0.3521, GLCT_params: a=2.0000, b=0.8324, d=0.4258
Reached max epochs. Best test accuracy: 0.4275
Final GLCT parameters: a=2.0000, b=0.8255, d=0.4282
Run 7 test accuracy: 0.4275 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6093, Val Acc=0.2487, Test Acc=0.2603, GLCT_params: a=1.5104, b=1.0110, d=0.4870
Epoch 100: Val Loss=1.5952, Val Acc=0.3737, Test Acc=0.3819, GLCT_params: a=1.7060, b=1.1691, d=0.3840
Epoch 200: Val Loss=1.5645, Val Acc=0.3783, Test Acc=0.3920, GLCT_params: a=1.9424, b=1.1453, d=0.5052
Epoch 300: Val Loss=1.5499, Val Acc=0.3553, Test Acc=0.3775, GLCT_params: a=2.0000, b=1.1756, d=0.5478
Epoch 400: Val Loss=1.5462, Val Acc=0.3533, Test Acc=0.3597, GLCT_params: a=2.0000, b=1.1562, d=0.3262
Epoch 500: Val Loss=1.5337, Val Acc=0.3375, Test Acc=0.3616, GLCT_params: a=2.0000, b=1.1356, d=0.3873
Epoch 600: Val Loss=1.5333, Val Acc=0.3421, Test Acc=0.3667, GLCT_params: a=2.0000, b=1.1773, d=0.4456
Epoch 700: Val Loss=1.5203, Val Acc=0.3355, Test Acc=0.3635, GLCT_params: a=2.0000, b=1.1358, d=0.3832
Epoch 800: Val Loss=1.5088, Val Acc=0.3421, Test Acc=0.3623, GLCT_params: a=2.0000, b=1.1278, d=0.3817
Epoch 900: Val Loss=1.5119, Val Acc=0.3362, Test Acc=0.3540, GLCT_params: a=2.0000, b=1.1223, d=0.3880
Epoch 1000: Val Loss=1.5170, Val Acc=0.3408, Test Acc=0.3597, GLCT_params: a=2.0000, b=1.1320, d=0.3626
Epoch 1100: Val Loss=1.4991, Val Acc=0.3388, Test Acc=0.3610, GLCT_params: a=2.0000, b=1.1115, d=0.3838
Epoch 1200: Val Loss=1.5009, Val Acc=0.3322, Test Acc=0.3553, GLCT_params: a=2.0000, b=1.1417, d=0.3825
Epoch 1300: Val Loss=1.4983, Val Acc=0.3342, Test Acc=0.3553, GLCT_params: a=2.0000, b=1.1012, d=0.3813
Epoch 1400: Val Loss=1.5080, Val Acc=0.3375, Test Acc=0.3566, GLCT_params: a=2.0000, b=1.1478, d=0.4091
Epoch 1500: Val Loss=1.4951, Val Acc=0.3303, Test Acc=0.3502, GLCT_params: a=2.0000, b=1.1151, d=0.3836
Early stopping at epoch 1544
Best test acc (by val loss): 0.3635
Best test acc (by val acc): 0.4180
Final GLCT parameters: a=2.0000, b=1.1323, d=0.3789
Run 8 test accuracy: 0.4237 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2243, Test Acc=0.2508, GLCT_params: a=1.4826, b=0.9897, d=0.5112
Epoch 100: Val Loss=1.5978, Val Acc=0.3711, Test Acc=0.3629, GLCT_params: a=1.5990, b=1.0358, d=0.4614
Epoch 200: Val Loss=1.5715, Val Acc=0.3757, Test Acc=0.3661, GLCT_params: a=1.8653, b=1.0372, d=0.5378
Epoch 300: Val Loss=1.5525, Val Acc=0.3579, Test Acc=0.3642, GLCT_params: a=1.8601, b=0.9637, d=0.4320
Epoch 400: Val Loss=1.5374, Val Acc=0.3566, Test Acc=0.3496, GLCT_params: a=1.9004, b=0.9716, d=0.4091
Epoch 500: Val Loss=1.5308, Val Acc=0.3526, Test Acc=0.3528, GLCT_params: a=2.0000, b=0.9878, d=0.3967
Epoch 600: Val Loss=1.5388, Val Acc=0.3421, Test Acc=0.3515, GLCT_params: a=2.0000, b=0.9735, d=0.3447
Epoch 700: Val Loss=1.5279, Val Acc=0.3474, Test Acc=0.3490, GLCT_params: a=2.0000, b=0.9809, d=0.3973
Epoch 800: Val Loss=1.5109, Val Acc=0.3513, Test Acc=0.3509, GLCT_params: a=2.0000, b=0.9486, d=0.4091
Epoch 900: Val Loss=1.5269, Val Acc=0.3461, Test Acc=0.3502, GLCT_params: a=2.0000, b=0.9894, d=0.4191
Early stopping at epoch 942
Best test acc (by val loss): 0.3477
Best test acc (by val acc): 0.4110
Final GLCT parameters: a=2.0000, b=0.9355, d=0.4257
Run 9 test accuracy: 0.4110 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='actor', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 2, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.0003, 'weight_decay': 0.0004, 'tran_dropout': 0.5, 'feat_dropout': 0.8, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 1.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 50.0}
Using GPU: NVIDIA RTX A6000
Parameters: 67693
GLCT parameters: a=1.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6093, Val Acc=0.2625, Test Acc=0.2552, GLCT_params: a=1.5099, b=0.9840, d=0.5113
Epoch 100: Val Loss=1.5996, Val Acc=0.3664, Test Acc=0.3914, GLCT_params: a=1.5716, b=0.9566, d=0.5760
Epoch 200: Val Loss=1.5680, Val Acc=0.3579, Test Acc=0.3597, GLCT_params: a=1.6925, b=0.9762, d=0.5817
Epoch 300: Val Loss=1.5536, Val Acc=0.3533, Test Acc=0.3604, GLCT_params: a=1.7478, b=0.9715, d=0.5626
Epoch 400: Val Loss=1.5380, Val Acc=0.3533, Test Acc=0.3547, GLCT_params: a=1.8087, b=0.9499, d=0.5672
Epoch 500: Val Loss=1.5351, Val Acc=0.3487, Test Acc=0.3483, GLCT_params: a=1.8518, b=0.9783, d=0.5518
Epoch 600: Val Loss=1.5332, Val Acc=0.3513, Test Acc=0.3509, GLCT_params: a=1.8937, b=0.9803, d=0.5600
Epoch 700: Val Loss=1.5267, Val Acc=0.3480, Test Acc=0.3534, GLCT_params: a=1.9673, b=0.9576, d=0.5612
Epoch 800: Val Loss=1.5209, Val Acc=0.3520, Test Acc=0.3547, GLCT_params: a=2.0000, b=0.9655, d=0.5429
Epoch 900: Val Loss=1.5087, Val Acc=0.3500, Test Acc=0.3534, GLCT_params: a=2.0000, b=0.9732, d=0.5443
Epoch 1000: Val Loss=1.5066, Val Acc=0.3467, Test Acc=0.3464, GLCT_params: a=2.0000, b=0.9829, d=0.5421
Epoch 1100: Val Loss=1.5022, Val Acc=0.3421, Test Acc=0.3445, GLCT_params: a=2.0000, b=0.9339, d=0.5612
Epoch 1200: Val Loss=1.5045, Val Acc=0.3513, Test Acc=0.3585, GLCT_params: a=2.0000, b=0.9727, d=0.5158
Epoch 1300: Val Loss=1.4929, Val Acc=0.3493, Test Acc=0.3521, GLCT_params: a=2.0000, b=0.9395, d=0.4895
Early stopping at epoch 1336
Best test acc (by val loss): 0.3509
Best test acc (by val acc): 0.4098
Final GLCT parameters: a=2.0000, b=0.9357, d=0.4869
Run 10 test accuracy: 0.4231 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.4222
Standard deviation: 0.0073
95% Confidence interval: [0.4177, 0.4268]




Chameleon运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000

Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.1780, Test Acc=0.1751, GLCT_params: a=0.4838, b=1.0224, d=0.5191
Epoch 100: Val Loss=1.3148, Val Acc=0.6088, Test Acc=0.6149, GLCT_params: a=0.4904, b=1.0089, d=0.5233
Epoch 200: Val Loss=1.0770, Val Acc=0.7165, Test Acc=0.7002, GLCT_params: a=0.3957, b=1.0345, d=0.6675
Epoch 300: Val Loss=1.1076, Val Acc=0.7473, Test Acc=0.7243, GLCT_params: a=0.4175, b=1.0388, d=0.6641
Epoch 400: Val Loss=1.0618, Val Acc=0.7560, Test Acc=0.7243, GLCT_params: a=0.4243, b=1.0394, d=0.6741
Epoch 500: Val Loss=1.2114, Val Acc=0.7560, Test Acc=0.7002, GLCT_params: a=0.4289, b=1.0335, d=0.6778
Epoch 600: Val Loss=1.0921, Val Acc=0.7670, Test Acc=0.7199, GLCT_params: a=0.4403, b=1.0321, d=0.6835
Early stopping at epoch 663
Best test acc (by val loss): 0.7133
Best test acc (by val acc): 0.7265
Final GLCT parameters: a=0.4424, b=1.0310, d=0.6846
Run 1 test accuracy: 0.7440 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6093, Val Acc=0.1978, Test Acc=0.2232, GLCT_params: a=0.5162, b=1.0233, d=0.4828
Epoch 100: Val Loss=1.5825, Val Acc=0.5978, Test Acc=0.6433, GLCT_params: a=0.5031, b=1.0431, d=0.5380
Epoch 200: Val Loss=1.2984, Val Acc=0.7187, Test Acc=0.7505, GLCT_params: a=0.4487, b=1.0502, d=0.6661
Epoch 300: Val Loss=1.3595, Val Acc=0.7341, Test Acc=0.7681, GLCT_params: a=0.4460, b=1.0557, d=0.6967
Early stopping at epoch 390
Best test acc (by val loss): 0.7352
Best test acc (by val acc): 0.7681
Final GLCT parameters: a=0.4517, b=1.0508, d=0.7082
Run 2 test accuracy: 0.7834 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6093, Val Acc=0.2527, Test Acc=0.2298, GLCT_params: a=0.4846, b=0.9852, d=0.5155
Epoch 100: Val Loss=1.6700, Val Acc=0.5143, Test Acc=0.5252, GLCT_params: a=0.3960, b=0.9237, d=0.5409
Epoch 200: Val Loss=1.2422, Val Acc=0.6637, Test Acc=0.6630, GLCT_params: a=0.4237, b=0.9059, d=0.5429
Epoch 300: Val Loss=1.1438, Val Acc=0.7187, Test Acc=0.7090, GLCT_params: a=0.3847, b=0.9242, d=0.6176
Epoch 400: Val Loss=1.1679, Val Acc=0.7319, Test Acc=0.7090, GLCT_params: a=0.3482, b=0.9393, d=0.6724
Epoch 500: Val Loss=1.1406, Val Acc=0.7429, Test Acc=0.7505, GLCT_params: a=0.3600, b=0.9320, d=0.6639
Early stopping at epoch 511
Best test acc (by val loss): 0.7090
Best test acc (by val acc): 0.7440
Final GLCT parameters: a=0.3501, b=0.9355, d=0.6760
Run 3 test accuracy: 0.7505 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6096, Val Acc=0.1670, Test Acc=0.1444, GLCT_params: a=0.5172, b=1.0204, d=0.4819
Epoch 100: Val Loss=1.6292, Val Acc=0.5209, Test Acc=0.5120, GLCT_params: a=1.0161, b=1.0773, d=0.2117
Epoch 200: Val Loss=1.5438, Val Acc=0.6418, Test Acc=0.6630, GLCT_params: a=1.1247, b=0.9789, d=-0.1140
Epoch 300: Val Loss=1.4244, Val Acc=0.6989, Test Acc=0.7133, GLCT_params: a=1.2427, b=0.9887, d=-0.0182
Epoch 400: Val Loss=1.3512, Val Acc=0.7165, Test Acc=0.7221, GLCT_params: a=1.2568, b=0.9988, d=-0.0312
Epoch 500: Val Loss=1.6040, Val Acc=0.6989, Test Acc=0.7199, GLCT_params: a=1.2881, b=0.9826, d=0.0272
Epoch 600: Val Loss=1.6207, Val Acc=0.7121, Test Acc=0.7068, GLCT_params: a=1.2966, b=0.9694, d=0.0303
Early stopping at epoch 602
Best test acc (by val loss): 0.7155
Best test acc (by val acc): 0.7287
Final GLCT parameters: a=1.2916, b=0.9622, d=0.0283
Run 4 test accuracy: 0.7396 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2088, Test Acc=0.2013, GLCT_params: a=0.4778, b=1.0159, d=0.5188
Epoch 100: Val Loss=1.3345, Val Acc=0.6681, Test Acc=0.6586, GLCT_params: a=0.3425, b=1.0003, d=0.6847
Epoch 200: Val Loss=1.3160, Val Acc=0.7055, Test Acc=0.7199, GLCT_params: a=0.3633, b=1.0070, d=0.6892
Epoch 300: Val Loss=1.3024, Val Acc=0.7121, Test Acc=0.7265, GLCT_params: a=0.3715, b=1.0028, d=0.6946
Epoch 400: Val Loss=1.1716, Val Acc=0.7231, Test Acc=0.7505, GLCT_params: a=0.3721, b=0.9991, d=0.7046
Early stopping at epoch 472
Best test acc (by val loss): 0.7352
Best test acc (by val acc): 0.7505
Final GLCT parameters: a=0.3834, b=1.0022, d=0.7025
Run 5 test accuracy: 0.7637 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.1978, Test Acc=0.2035, GLCT_params: a=0.4817, b=1.0222, d=0.5228
Epoch 100: Val Loss=1.0216, Val Acc=0.6967, Test Acc=0.6893, GLCT_params: a=0.3263, b=1.0774, d=0.8087
Epoch 200: Val Loss=1.1485, Val Acc=0.7692, Test Acc=0.7440, GLCT_params: a=0.3440, b=1.0834, d=0.8289
Epoch 300: Val Loss=1.0907, Val Acc=0.7648, Test Acc=0.7615, GLCT_params: a=0.3562, b=1.0748, d=0.8239
Early stopping at epoch 345
Best test acc (by val loss): 0.7418
Best test acc (by val acc): 0.7702
Final GLCT parameters: a=0.3616, b=1.0793, d=0.8283
Run 6 test accuracy: 0.7724 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6096, Val Acc=0.1538, Test Acc=0.1554, GLCT_params: a=0.4840, b=0.9833, d=0.4800
Epoch 100: Val Loss=1.6150, Val Acc=0.5495, Test Acc=0.5339, GLCT_params: a=0.5301, b=0.8869, d=0.4570
Epoch 200: Val Loss=1.4104, Val Acc=0.6418, Test Acc=0.7374, GLCT_params: a=0.3507, b=0.9664, d=0.6653
Epoch 300: Val Loss=1.2133, Val Acc=0.7297, Test Acc=0.7615, GLCT_params: a=0.3466, b=0.9717, d=0.6718
Epoch 400: Val Loss=1.1552, Val Acc=0.7319, Test Acc=0.7724, GLCT_params: a=0.3482, b=0.9699, d=0.6717
Epoch 500: Val Loss=1.0906, Val Acc=0.7429, Test Acc=0.7812, GLCT_params: a=0.3497, b=0.9723, d=0.6752
Epoch 600: Val Loss=1.1347, Val Acc=0.7407, Test Acc=0.7768, GLCT_params: a=0.3501, b=0.9708, d=0.6776
Epoch 700: Val Loss=1.1625, Val Acc=0.7363, Test Acc=0.7571, GLCT_params: a=0.3569, b=0.9669, d=0.6832
Early stopping at epoch 700
Best test acc (by val loss): 0.7812
Best test acc (by val acc): 0.7615
Final GLCT parameters: a=0.3569, b=0.9669, d=0.6832
Run 7 test accuracy: 0.7877 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6093, Val Acc=0.2725, Test Acc=0.2210, GLCT_params: a=0.4787, b=1.0165, d=0.5215
Epoch 100: Val Loss=1.0094, Val Acc=0.7055, Test Acc=0.6652, GLCT_params: a=0.4616, b=1.1109, d=0.5995
Epoch 200: Val Loss=0.9235, Val Acc=0.7626, Test Acc=0.7418, GLCT_params: a=0.4697, b=1.1077, d=0.6526
Epoch 300: Val Loss=1.0198, Val Acc=0.7560, Test Acc=0.7462, GLCT_params: a=0.4641, b=1.0984, d=0.6723
Epoch 400: Val Loss=0.9016, Val Acc=0.7736, Test Acc=0.7440, GLCT_params: a=0.4845, b=1.0993, d=0.6426
Early stopping at epoch 445
Best test acc (by val loss): 0.7440
Best test acc (by val acc): 0.7615
Final GLCT parameters: a=0.4810, b=1.1045, d=0.7037
Run 8 test accuracy: 0.7856 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2659, Test Acc=0.2210, GLCT_params: a=0.4774, b=0.9847, d=0.5161
Epoch 100: Val Loss=1.9519, Val Acc=0.4923, Test Acc=0.4748, GLCT_params: a=0.8617, b=0.9088, d=0.2763
Epoch 200: Val Loss=1.5804, Val Acc=0.6418, Test Acc=0.6280, GLCT_params: a=0.9962, b=0.8806, d=0.1892
Epoch 300: Val Loss=1.3836, Val Acc=0.7033, Test Acc=0.6937, GLCT_params: a=1.1208, b=0.8633, d=0.2018
Epoch 400: Val Loss=1.5098, Val Acc=0.7187, Test Acc=0.7002, GLCT_params: a=1.0767, b=0.8860, d=-0.2061
Epoch 500: Val Loss=1.4890, Val Acc=0.7187, Test Acc=0.7090, GLCT_params: a=1.0830, b=0.8815, d=-0.1973
Early stopping at epoch 557
Best test acc (by val loss): 0.7199
Best test acc (by val acc): 0.7002
Final GLCT parameters: a=1.0853, b=0.8819, d=-0.1995
Run 9 test accuracy: 0.7462 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='chameleon', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.001, 'weight_decay': 0.0005, 'tran_dropout': 0.2, 'feat_dropout': 0.4, 'prop_dropout': 0.5, 'norm': 'none', 'glct_a': 0.5, 'glct_b': 1.0, 'glct_d': 0.5, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 156931
GLCT parameters: a=0.5, b=1.0, d=0.5
Epoch 0: Val Loss=1.6094, Val Acc=0.2022, Test Acc=0.2079, GLCT_params: a=0.4799, b=0.9788, d=0.4765
Epoch 100: Val Loss=1.6149, Val Acc=0.5495, Test Acc=0.5295, GLCT_params: a=0.3913, b=0.9111, d=0.5237
Epoch 200: Val Loss=1.1960, Val Acc=0.7055, Test Acc=0.6893, GLCT_params: a=0.3914, b=0.9155, d=0.5462
Epoch 300: Val Loss=1.2416, Val Acc=0.7143, Test Acc=0.7002, GLCT_params: a=0.4033, b=0.9021, d=0.5599
Epoch 400: Val Loss=1.3048, Val Acc=0.7231, Test Acc=0.7002, GLCT_params: a=0.4135, b=0.8971, d=0.5617
Early stopping at epoch 421
Best test acc (by val loss): 0.7024
Best test acc (by val acc): 0.6937
Final GLCT parameters: a=0.4050, b=0.8996, d=0.5790
Run 10 test accuracy: 0.7221 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.7595
Standard deviation: 0.0213
95% Confidence interval: [0.7463, 0.7727]





Squirrel运行结果：
=== Run 1/10 ===
Args: Namespace(seed=0, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.1933, Test Acc=0.2277, GLCT_params: a=0.4433, b=0.9626, d=0.1593
Epoch 100: Val Loss=1.4312, Val Acc=0.4856, Test Acc=0.4870, GLCT_params: a=0.5940, b=0.8520, d=0.2315
Epoch 200: Val Loss=1.2939, Val Acc=0.5913, Test Acc=0.5735, GLCT_params: a=0.6289, b=0.8103, d=0.1633
Epoch 300: Val Loss=1.2727, Val Acc=0.6038, Test Acc=0.5841, GLCT_params: a=0.6313, b=0.8056, d=0.1644
Epoch 400: Val Loss=1.2399, Val Acc=0.6115, Test Acc=0.5975, GLCT_params: a=0.6411, b=0.8008, d=0.1539
Epoch 500: Val Loss=1.2930, Val Acc=0.6327, Test Acc=0.6119, GLCT_params: a=0.6498, b=0.7969, d=0.1426
Epoch 600: Val Loss=1.3466, Val Acc=0.6096, Test Acc=0.5956, GLCT_params: a=0.6987, b=0.7591, d=-0.3607
Epoch 700: Val Loss=1.3984, Val Acc=0.6019, Test Acc=0.5821, GLCT_params: a=0.7242, b=0.7320, d=-0.4082
Epoch 800: Val Loss=1.3927, Val Acc=0.6096, Test Acc=0.6119, GLCT_params: a=0.7322, b=0.7246, d=-0.4735
Early stopping at epoch 833
Best test acc (by val loss): 0.5985
Best test acc (by val acc): 0.6148
Final GLCT parameters: a=0.7397, b=0.7229, d=-0.5511
Run 1 test accuracy: 0.6321 (VALID)

=== Run 2/10 ===
Args: Namespace(seed=1, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.2067, Test Acc=0.2305, GLCT_params: a=0.3565, b=1.0434, d=0.2426
Epoch 100: Val Loss=1.4156, Val Acc=0.4779, Test Acc=0.5101, GLCT_params: a=0.2320, b=1.3242, d=0.8441
Epoch 200: Val Loss=1.3425, Val Acc=0.5788, Test Acc=0.5860, GLCT_params: a=0.4672, b=1.3106, d=1.0364
Epoch 300: Val Loss=1.3573, Val Acc=0.5798, Test Acc=0.6042, GLCT_params: a=0.4966, b=1.3124, d=1.0706
Epoch 400: Val Loss=1.4159, Val Acc=0.6038, Test Acc=0.6215, GLCT_params: a=0.5258, b=1.3033, d=1.0842
Epoch 500: Val Loss=1.5025, Val Acc=0.6029, Test Acc=0.6186, GLCT_params: a=0.6198, b=1.2998, d=1.1912
Epoch 600: Val Loss=1.4578, Val Acc=0.6067, Test Acc=0.6148, GLCT_params: a=0.6765, b=1.2906, d=1.1761
Epoch 700: Val Loss=1.2771, Val Acc=0.6163, Test Acc=0.6129, GLCT_params: a=0.6921, b=1.2801, d=1.5735
Early stopping at epoch 726
Best test acc (by val loss): 0.6196
Best test acc (by val acc): 0.6359
Final GLCT parameters: a=0.7041, b=1.2949, d=1.7734
Run 2 test accuracy: 0.6446 (VALID)

=== Run 3/10 ===
Args: Namespace(seed=2, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6095, Val Acc=0.2038, Test Acc=0.2085, GLCT_params: a=0.3646, b=1.0445, d=0.2356
Epoch 100: Val Loss=1.3966, Val Acc=0.4548, Test Acc=0.4323, GLCT_params: a=0.1958, b=1.2209, d=0.4554
Epoch 200: Val Loss=1.3610, Val Acc=0.5135, Test Acc=0.4995, GLCT_params: a=0.2467, b=1.2353, d=0.4892
Epoch 300: Val Loss=1.2327, Val Acc=0.5875, Test Acc=0.6004, GLCT_params: a=0.2529, b=1.2256, d=0.5148
Epoch 400: Val Loss=1.1586, Val Acc=0.6067, Test Acc=0.6177, GLCT_params: a=0.2927, b=1.2209, d=0.5796
Epoch 500: Val Loss=1.1501, Val Acc=0.6558, Test Acc=0.6455, GLCT_params: a=0.3379, b=1.2149, d=0.5881
Epoch 600: Val Loss=1.2223, Val Acc=0.6500, Test Acc=0.6455, GLCT_params: a=0.2643, b=1.2220, d=0.7764
Early stopping at epoch 673
Best test acc (by val loss): 0.6388
Best test acc (by val acc): 0.6407
Final GLCT parameters: a=0.2559, b=1.2259, d=0.7891
Run 3 test accuracy: 0.6580 (VALID)

=== Run 4/10 ===
Args: Namespace(seed=3, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.2471, Test Acc=0.2248, GLCT_params: a=0.4373, b=0.9605, d=0.1587
Epoch 100: Val Loss=1.3983, Val Acc=0.4798, Test Acc=0.4774, GLCT_params: a=0.6494, b=0.7915, d=0.1308
Epoch 200: Val Loss=1.4030, Val Acc=0.5394, Test Acc=0.5303, GLCT_params: a=0.7049, b=0.7427, d=0.0304
Epoch 300: Val Loss=1.3368, Val Acc=0.5846, Test Acc=0.5696, GLCT_params: a=0.6982, b=0.7505, d=0.1258
Epoch 400: Val Loss=1.3224, Val Acc=0.5923, Test Acc=0.6023, GLCT_params: a=0.7130, b=0.7468, d=0.1136
Epoch 500: Val Loss=1.3068, Val Acc=0.6096, Test Acc=0.6167, GLCT_params: a=0.7393, b=0.7184, d=0.0024
Epoch 600: Val Loss=1.4136, Val Acc=0.6212, Test Acc=0.6254, GLCT_params: a=0.7646, b=0.6961, d=0.0117
Epoch 700: Val Loss=1.2363, Val Acc=0.6404, Test Acc=0.6455, GLCT_params: a=0.8202, b=0.6373, d=-0.1132
Epoch 800: Val Loss=1.2370, Val Acc=0.6481, Test Acc=0.6398, GLCT_params: a=0.8515, b=0.6228, d=-0.1169
Epoch 900: Val Loss=1.3196, Val Acc=0.6529, Test Acc=0.6523, GLCT_params: a=0.8868, b=0.5659, d=-0.1954
Early stopping at epoch 927
Best test acc (by val loss): 0.6465
Best test acc (by val acc): 0.6532
Final GLCT parameters: a=0.8863, b=0.5601, d=-0.2107
Run 4 test accuracy: 0.6599 (VALID)

=== Run 5/10 ===
Args: Namespace(seed=4, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.1788, Test Acc=0.2200, GLCT_params: a=0.3574, b=1.0360, d=0.2389
Epoch 100: Val Loss=1.3918, Val Acc=0.5481, Test Acc=0.5351, GLCT_params: a=-0.1241, b=1.1819, d=0.8542
Epoch 200: Val Loss=1.3207, Val Acc=0.5644, Test Acc=0.5476, GLCT_params: a=-0.0334, b=1.1644, d=1.0481
Epoch 300: Val Loss=1.3432, Val Acc=0.6115, Test Acc=0.5975, GLCT_params: a=-0.0264, b=1.1906, d=1.4139
Epoch 400: Val Loss=1.4720, Val Acc=0.5731, Test Acc=0.5879, GLCT_params: a=-0.0222, b=1.1889, d=1.4530
Epoch 500: Val Loss=1.3218, Val Acc=0.5923, Test Acc=0.6042, GLCT_params: a=0.0632, b=1.1923, d=1.5787
Epoch 600: Val Loss=1.3203, Val Acc=0.5865, Test Acc=0.6042, GLCT_params: a=0.0458, b=1.1935, d=1.5796
Early stopping at epoch 631
Best test acc (by val loss): 0.6052
Best test acc (by val acc): 0.6196
Final GLCT parameters: a=0.0306, b=1.1924, d=1.6346
Run 5 test accuracy: 0.6513 (VALID)

=== Run 6/10 ===
Args: Namespace(seed=5, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.1971, Test Acc=0.2046, GLCT_params: a=0.3613, b=1.0424, d=0.2429
Epoch 100: Val Loss=1.3831, Val Acc=0.5048, Test Acc=0.5552, GLCT_params: a=0.5739, b=0.8725, d=0.1292
Epoch 200: Val Loss=1.4054, Val Acc=0.5317, Test Acc=0.5572, GLCT_params: a=0.5796, b=0.8828, d=0.2016
Epoch 300: Val Loss=1.2246, Val Acc=0.6000, Test Acc=0.6033, GLCT_params: a=0.5911, b=0.8419, d=0.1926
Epoch 400: Val Loss=1.3080, Val Acc=0.6096, Test Acc=0.6071, GLCT_params: a=0.6252, b=0.8284, d=0.1347
Epoch 500: Val Loss=1.3340, Val Acc=0.5981, Test Acc=0.6052, GLCT_params: a=0.6317, b=0.8302, d=0.1754
Epoch 600: Val Loss=1.3403, Val Acc=0.6173, Test Acc=0.6369, GLCT_params: a=0.6513, b=0.8087, d=0.0715
Early stopping at epoch 649
Best test acc (by val loss): 0.6398
Best test acc (by val acc): 0.6532
Final GLCT parameters: a=0.6490, b=0.8098, d=0.1013
Run 6 test accuracy: 0.6657 (VALID)

=== Run 7/10 ===
Args: Namespace(seed=6, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.2192, Test Acc=0.2104, GLCT_params: a=0.4427, b=0.9644, d=0.1600
Epoch 100: Val Loss=1.3737, Val Acc=0.5173, Test Acc=0.5062, GLCT_params: a=0.5360, b=0.8762, d=0.1352
Epoch 200: Val Loss=1.3814, Val Acc=0.5625, Test Acc=0.5773, GLCT_params: a=0.6106, b=0.8203, d=-0.0229
Epoch 300: Val Loss=1.2815, Val Acc=0.5962, Test Acc=0.6196, GLCT_params: a=0.6200, b=0.8171, d=-0.0006
Epoch 400: Val Loss=1.2025, Val Acc=0.5894, Test Acc=0.6234, GLCT_params: a=0.6546, b=0.8071, d=-0.0484
Epoch 500: Val Loss=1.2502, Val Acc=0.5971, Test Acc=0.6282, GLCT_params: a=0.7129, b=0.7621, d=-0.3992
Epoch 600: Val Loss=1.3750, Val Acc=0.6183, Test Acc=0.6244, GLCT_params: a=0.7245, b=0.7416, d=-0.4695
Epoch 700: Val Loss=1.3803, Val Acc=0.6019, Test Acc=0.6330, GLCT_params: a=0.7405, b=0.7278, d=-0.6119
Early stopping at epoch 772
Best test acc (by val loss): 0.6340
Best test acc (by val acc): 0.6398
Final GLCT parameters: a=0.7384, b=0.7220, d=-0.6060
Run 7 test accuracy: 0.6513 (VALID)

=== Run 8/10 ===
Args: Namespace(seed=7, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.2019, Test Acc=0.2133, GLCT_params: a=0.4382, b=0.9566, d=0.1615
Epoch 100: Val Loss=1.5320, Val Acc=0.4346, Test Acc=0.4140, GLCT_params: a=0.7019, b=0.8819, d=0.2293
Epoch 200: Val Loss=1.3789, Val Acc=0.5385, Test Acc=0.5159, GLCT_params: a=0.7214, b=0.8691, d=0.2367
Epoch 300: Val Loss=1.2607, Val Acc=0.6058, Test Acc=0.5658, GLCT_params: a=0.7916, b=0.8287, d=0.2093
Epoch 400: Val Loss=1.2362, Val Acc=0.6144, Test Acc=0.5946, GLCT_params: a=0.8324, b=0.7948, d=0.1487
Epoch 500: Val Loss=1.1661, Val Acc=0.6404, Test Acc=0.5956, GLCT_params: a=0.8626, b=0.7801, d=0.0834
Epoch 600: Val Loss=1.2052, Val Acc=0.6192, Test Acc=0.6148, GLCT_params: a=0.9603, b=0.7089, d=0.0054
Early stopping at epoch 681
Best test acc (by val loss): 0.6100
Best test acc (by val acc): 0.6158
Final GLCT parameters: a=0.9742, b=0.6836, d=-0.0010
Run 8 test accuracy: 0.6378 (VALID)

=== Run 9/10 ===
Args: Namespace(seed=8, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6095, Val Acc=0.2019, Test Acc=0.2161, GLCT_params: a=0.3577, b=1.0445, d=0.2361
Epoch 100: Val Loss=1.3426, Val Acc=0.5394, Test Acc=0.5312, GLCT_params: a=0.6071, b=0.8458, d=0.0945
Epoch 200: Val Loss=1.3644, Val Acc=0.5827, Test Acc=0.5879, GLCT_params: a=0.6520, b=0.8113, d=0.0674
Epoch 300: Val Loss=1.2425, Val Acc=0.6135, Test Acc=0.6033, GLCT_params: a=0.6573, b=0.8057, d=0.0712
Epoch 400: Val Loss=1.4412, Val Acc=0.5875, Test Acc=0.5764, GLCT_params: a=0.7261, b=0.7393, d=-0.0510
Early stopping at epoch 484
Best test acc (by val loss): 0.6177
Best test acc (by val acc): 0.6004
Final GLCT parameters: a=0.7789, b=0.6952, d=-0.1751
Run 9 test accuracy: 0.6244 (VALID)

=== Run 10/10 ===
Args: Namespace(seed=9, cuda=0, dataset='squirrel', image=0, runs=10, seed_start=0)
Config: {'nclass': 5, 'nlayer': 2, 'num_heads': 4, 'hidden_dim': 32, 'epoch': 2000, 'lr': 0.002, 'weight_decay': 0.001, 'tran_dropout': 0.1, 'feat_dropout': 0.4, 'prop_dropout': 0.4, 'norm': 'none', 'glct_a': 0.4, 'glct_b': 1.0, 'glct_d': 0.2, 'glct_lr_multiplier': 20.0}
Using GPU: NVIDIA RTX A6000
Parameters: 141827
GLCT parameters: a=0.4, b=1.0, d=0.2
Epoch 0: Val Loss=1.6094, Val Acc=0.2019, Test Acc=0.1796, GLCT_params: a=0.4396, b=0.9587, d=0.1564
Epoch 100: Val Loss=1.2952, Val Acc=0.5452, Test Acc=0.4976, GLCT_params: a=0.6777, b=0.6373, d=-0.3787
Epoch 200: Val Loss=1.3033, Val Acc=0.5683, Test Acc=0.5379, GLCT_params: a=0.6871, b=0.6422, d=-0.3512
Epoch 300: Val Loss=1.2895, Val Acc=0.5769, Test Acc=0.5725, GLCT_params: a=0.7088, b=0.6028, d=-0.3630
Epoch 400: Val Loss=1.2088, Val Acc=0.6298, Test Acc=0.6282, GLCT_params: a=0.7825, b=0.5103, d=-0.6354
Epoch 500: Val Loss=1.3096, Val Acc=0.5981, Test Acc=0.5764, GLCT_params: a=0.7782, b=0.4854, d=-0.7051
Epoch 600: Val Loss=1.2278, Val Acc=0.6317, Test Acc=0.6186, GLCT_params: a=0.8003, b=0.4509, d=-0.8382
Epoch 700: Val Loss=1.2035, Val Acc=0.6365, Test Acc=0.6311, GLCT_params: a=0.8089, b=0.4172, d=-0.8993
Early stopping at epoch 753
Best test acc (by val loss): 0.6455
Best test acc (by val acc): 0.6388
Final GLCT parameters: a=0.8205, b=0.4091, d=-0.9078
Run 10 test accuracy: 0.6551 (VALID)

=== Final Results (10/10 valid runs) ===
Mean test accuracy: 0.6480
Standard deviation: 0.0125
95% Confidence interval: [0.6403, 0.6558]

